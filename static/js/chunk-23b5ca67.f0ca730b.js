/*!
 *  build: 杭州数蛙科技有限公司 
 *  copyright: dgiot_dashboard 
 *  time: Fri Aug 06 2021 11:34:44 GMT+0000 (Coordinated Universal Time)
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23b5ca67"],{"03cf":function(e,t,a){},"05cc":function(e,t,a){"use strict";a("cc9a")},"08dd":function(e,t,a){"use strict";a("3112")},"0daa":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rulesengine"},[a("div",{staticClass:"engintable"},[a("div",{staticClass:"engineheader"},[a("el-button",{staticStyle:{float:"right",margin:"19px 0"},attrs:{disabled:e.alarmsRuleId.length>0&&e.engineData.length>0,type:"primary",icon:"el-icon-plus",size:"small"},on:{click:e.addEngine}},[e._v(" "+e._s(e.$translateTitle("developer.add"))+" ")])],1),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.engineData,"cell-class-name":e.getRowindex}},[a("el-table-column",{attrs:{label:"ID",align:"center","show-overflow-tooltip":"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{on:{click:function(a){return e.detailRules(t.row.id)}}},[e._v(e._s(t.row.id))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("leftbar.topics"),align:"center","show-overflow-tooltip":"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.for.join(",")))])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"200",prop:"rawsql",align:"center",label:"SQL"}}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.ResponseAction"),align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.actions,(function(t,n){return a("p",{key:n},[e._v(" "+e._s(t.name)+" ")])}))}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("product.hit")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.matched(t.row.metrics)))])]}}])}),a("el-table-column",{attrs:{align:"center",label:e.$translateTitle("equipment.state")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.changeRule(t.row.id,t.row.enabled)}},model:{value:t.row.enabled,callback:function(a){e.$set(t.row,"enabled",a)},expression:"scope.row.enabled"}})]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),align:"center",fixed:"right",width:"210"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.detailRules(t.row.id)}}},[e._v(" "+e._s(e.$translateTitle("equipment.see"))+" ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editRule(t.row.id)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteRule(t.row.id)}}},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])]}}])})],1),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.pagesize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},r=[],l=a("1da1"),i=(a("96cf"),a("99af"),a("d81d"),a("b0c0"),a("a15b"),a("1b07")),s=(a("7497"),{data:function(){return{engineData:[],pagesize:10,start:0,total:0,productid:this.$route.query.productid||"",ruleType:this.$route.query.type||"",uid:this.$route.query.uuid||"",alarmsRuleId:""}},mounted:function(){this.featchData({})},methods:{featchData:function(e){this.productid&&this.uid&&this.ruleType?(this.alarmsRuleId="rule:".concat(this.ruleType,"_").concat(this.productid,"_").concat(this.uid),this.getalarmsRule(this.alarmsRuleId)):this.orginRule()},getalarmsRule:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["getRuleDetail"])(e);case 2:n=a.sent,r=[],r.push(n.data),t.engineData=r,t.total=t.engineData.length;case 7:case"end":return a.stop()}}),a)})))()},orginRule:function(){var e=this;Object(i["getRule"])({}).then((function(t){t&&(e.engineData=t.data,e.total=e.engineData.length)})).catch((function(t){e.$message(t.error)}))},handleSizeChange:function(e){},handleCurrentChange:function(e){},addEngine:function(){var e={title:"新增"};this.productid.length&&(e["productid"]=this.productid),this.uid.length&&(e["uid"]=this.uid),this.ruleType.length&&(e["type"]=this.ruleType),this.$router.push({path:"/rules_engine/addengine",query:e})},matched:function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a].matched;return t},changeRule:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={enabled:t},n.next=3,Object(i["put_rule_id"])(e,r);case 3:n.sent,a.$message("状态修改成功");case 5:case"end":return n.stop()}}),n)})))()},actions:function(e){return e.map((function(e){return e.name})),string.join(",")},getRowindex:function(e,t,a){if(0==e.columnIndex)return"firstcolumn"},detailRules:function(e){this.$router.push({path:"/rules_engine/checkengine",query:{id:e}})},editRule:function(e){this.$router.push({path:"/rules_engine/addengine",query:{id:e,title:"编辑"}})},deleteRule:function(e){var t=this;Object(i["ruleDelete"])(e).then((function(e){e&&(t.$message("删除成功"),t.orginRule())})).catch((function(e){t.$message(e.error)}))}}}),o=s,c=(a("78c5"),a("2877")),d=Object(c["a"])(o,n,r,!1,null,"326c36f0",null);t["default"]=d.exports},"143e":function(e,t,a){},"1be0":function(e,t,a){"use strict";a("5507")},"1be9":function(e,t,a){"use strict";a("3450")},3112:function(e,t,a){},3450:function(e,t,a){},"3cde":function(e,t,a){},"3e1f":function(e,t,a){"use strict";a("79e2")},"3e38":function(e,t,a){"use strict";a("8e1a")},"49fb":function(e,t,a){"use strict";a("cbd7")},"51e6":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"addApp"}},[a("div",{staticClass:"head"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/roles/applicationManagement"}}},[e._v(" "+e._s(e.$translateTitle("application.applicationmanagement"))+" ")]),a("el-breadcrumb-item",[e._v(" "+e._s("update"==e.actionType?"编辑应用":"新增应用")+" ")])],1),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:e.handleClickBack}},[e._v(" "+e._s(e.$translateTitle("application.return"))+" ")])],1),a("div",{staticClass:"form"},[a("div",{staticClass:"title"},[a("p",{staticStyle:{color:"#f00"}},[e._v(" "+e._s("*"+e.$translateTitle("application.mustfillin"))+" ")])]),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"180px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{rules:[{required:!0,message:"工程单位不能为空"}],label:"工程单位",prop:"department"}},[a("el-input",{attrs:{placeholder:"工程单位"},model:{value:e.form.department,callback:function(t){e.$set(e.form,"department",t)},expression:"form.department"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationname"),rules:[{required:!0,message:"工程名称不能为空"}],prop:"name"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.applicationname"),readonly:""},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationlink"),rules:[{required:!0,message:"工程链接不能为空"}],prop:"productIdentifier"}},[a("el-select",{attrs:{placeholder:"请选择",disabled:""},model:{value:e.form.productIdentifier,callback:function(t){e.$set(e.form,"productIdentifier",t)},expression:"form.productIdentifier"}},e._l(e.applicationList,(function(t){return a("el-option",{key:t.id,attrs:{label:e.host+t.desc,value:t.desc}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.industrytype"),rules:[{required:!0,message:"请选择所属行业",trigger:"blur"}],prop:"category"}},[a("el-cascader",{ref:"category",attrs:{options:e.treeData,placeholder:e.$translateTitle("application.industrytype"),clearable:""},model:{value:e.form.category,callback:function(t){e.$set(e.form,"category",t)},expression:"form.category"}})],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"请选择所属应用",trigger:"blur"}],label:"所属应用"}},[a("el-input",{attrs:{placeholder:"请选择所属应用"},model:{value:e.form.relationApp,callback:function(t){e.$set(e.form,"relationApp",t)},expression:"form.relationApp"}},[a("template",{slot:"append"},[a("i",{class:[e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{cursor:"pointer"},on:{click:function(t){e.showTree=!e.showTree}}})])],2),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationdescription")}},[a("el-input",{attrs:{rows:4,placeholder:e.$translateTitle("application.applicationdescription"),type:"textarea",maxlength:"300","show-word-limit":""},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)]),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple-light"},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationpictures")}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"file-list":e.form.fileList,"auto-upload":!1,limit:1,"on-success":e.handleSuccess,action:"/upload","list-type":"picture"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload}},[e._v(" "+e._s(e.$translateTitle("application.uploadtoserver"))+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.img,expression:"form.img != ''"}]},[e._v(" "+e._s(e.$translateTitle("developer.path"))+":"+e._s(e.form.img)+" ")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" "+e._s(e.$translateTitle("application.onlyJPG/PNGfilescanbeuploadedandnomorethan500kb"))+" ")])],1)],1),a("el-form-item",{attrs:{label:"背景图片"}},[a("el-upload",{ref:"upload1",staticClass:"upload-demo",attrs:{"file-list":e.form.fileList1,"auto-upload":!1,limit:1,"on-success":e.handleSuccess1,action:"/upload","list-type":"picture"}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v(" "+e._s(e.$translateTitle("application.selectfile"))+" ")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:e.submitUpload1}},[e._v(" "+e._s(e.$translateTitle("application.uploadtoserver"))+" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:""!=e.form.img1,expression:"form.img1 != ''"}]},[e._v(" "+e._s(e.$translateTitle("developer.path"))+":"+e._s(e.form.img1)+" ")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" "+e._s(e.$translateTitle("application.onlyJPG/PNGfilescanbeuploadedandnomorethan500kb"))+" ")])],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.copyrightinformation")}},[a("el-input",{attrs:{rows:3,placeholder:e.$translateTitle("application.copyrightinformation"),type:"textarea",maxlength:"300","show-word-limit":""},model:{value:e.form.copyright,callback:function(t){e.$set(e.form,"copyright",t)},expression:"form.copyright"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.monitoringpanel")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.monitoringpanel")},model:{value:e.form.dashboard,callback:function(t){e.$set(e.form,"dashboard",t)},expression:"form.dashboard"}},[a("template",{slot:"prepend"},[e._v("http://")]),a("el-button",{staticStyle:{color:"#ffffff",background:"#409eff","border-radius":"1px 1px 1px 0"},attrs:{slot:"append",type:"primary"},on:{click:e.open12},slot:"append"},[e._v(" "+e._s(e.$translateTitle("application.preview"))+" ")])],2)],1)],1)])],1),a("el-divider",[a("b",[e._v(e._s(e.$translateTitle("application.applicationconfiguration")))])]),a("el-row",[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationaccessscale"),rules:[{required:!0,message:"请选择工程接入规模",trigger:"change"}],prop:"scale"}},[a("el-select",{attrs:{clearable:""},model:{value:e.form.scale,callback:function(t){e.$set(e.form,"scale",e._n(t))},expression:"form.scale"}},e._l(e.form.scaleDate,(function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.value}})})),1)],1)],1)])],1)],1),a("div",{staticClass:"btns"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"add"==e.actionType,expression:"actionType == 'add'"}],attrs:{type:"primary"},on:{click:e.handleClickSubmit}},[e._v(" "+e._s(e.$translateTitle("application.submission"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"update"==e.actionType,expression:"actionType == 'update'"}],attrs:{type:"primary"},on:{click:e.handleClickUpdate}},[e._v(" 更新 ")])],1)],1)])},r=[],l=a("1da1"),i=a("5530"),s=(a("96cf"),a("4de4"),a("a9e3"),a("b0c0"),a("ac1f"),a("1276"),a("a15b"),a("d81d"),a("5880")),o=a("e0e9"),c=a("ed08"),d=a("58dd"),u=a("7212"),p=a("5dca"),m={data:function(){return{imageUrl:!1,host:window.location.origin+"/lot/",applicationList:[],form:{name:"",options:[],category:[],relationApp:"",number:"",code:"",scale:"",dashboard:"",product:[],department:"",scaleDate:[{id:0,value:100,label:"100"},{id:1,value:1e3,label:"1000"},{id:2,value:1e4,label:"1万"},{id:3,value:1e5,label:"10万"},{id:4,value:1e6,label:"100万"},{id:5,value:1e7,label:"1000万"},{id:6,value:1e8,label:"1亿"}],productIdentifier:"",fileList:[],fileList1:[],img:"",img1:"",copyright:"",desc:"",time:7200,secret:""},sessionToken:"",file:"",actionType:"",relationAppObjectId:"",content:{title:"",objectId:""},argu:{},Notification:"",showTree:!1,allApps:[],defaultProps:{children:"children",label:"label"},productlist:[]}},computed:Object(i["a"])(Object(i["a"])({},Object(s["mapGetters"])({roleTree:"user/roleTree"})),{},{treeData:function(){var e=JSON.parse(JSON.stringify(this.form.options));return e.filter((function(t){var a=e.filter((function(e){return t.id==e.parentid}));return a.length>0&&(t.children=a),0==t.parentid}))},applicationData:function(){return[]}}),created:function(){this.Industry(),this.randomSecret(),this.getProductList()},mounted:function(){this.initData()},beforeDestroy:function(){this.Notification&&this.Notification.close()},methods:{handleClickRefresh:function(){this.randomSecret()},onApplicationchange:function(e){},getProductList:function(e){var t=this;this.$query_object("Product",{}).then((function(e){e.results&&(t.productlist=e.results)}))},randomSecret:function(){var e=Math.ceil(25*Math.random());this.form.secret=Base64.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date))},initData:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.argu=e.$route.query,e.content.title=e.argu.title,e.actionType=e.argu.actionType,t.next=5,Object(d["app_count"])({limit:100,where:{}});case 5:a=t.sent,n=a.results,n&&(e.applicationList=n,"update"==e.actionType?(e.form.name=e.argu.name,e.form.scale=Number(Object(c["handleZero"])(e.argu.scale)),e.form.secret=e.argu.secret,e.form.productIdentifier=e.argu.productIdentifier,e.content.objectId=e.argu.objectId,e.form.department=e.argu.userUnit,e.form.desc=e.argu.desc,e.form.copyright=e.argu.copyright,e.argu.category&&(e.form.category=e.argu.category.split("/")),e.argu.dashboard?e.form.dashboard=e.argu.dashboard.substr(7):e.form.dashboard="",""!=e.argu.logo&&(e.form.img=e.argu.logo,e.form.fileList.push({name:"logo.png",url:e.argu.logo})),""!=e.argu.background&&(e.form.img1=e.argu.background,e.form.fileList1.push({name:"background.png",url:e.argu.background})),e.form.relationApp=e.argu.name):(e.relationAppObjectId=e.$route.query.appObjectId,e.form.relationApp=e.$route.query.name,e.form.productIdentifier=e.$route.query.desc,e.form.name=e.$route.query.desc));case 8:case"end":return t.stop()}}),t)})))()},handleClickBack:function(){this.$router.push({path:"/roles/applicationManagement"})},submitUpload:function(){this.$refs.upload.submit()},handleChangeFile:function(e){var t=e.target.files[0],a=t.name.substr(-3);t.size/1024>500?this.$message("上传图片大小不能超过500KB!"):"png"!=a&&"jpg"!=a?this.$message("上传图片格式不正确，必须是png或jpg格式！"):this.file=t},handleSuccess:function(e,t,a){this.form.img=e.path,this.$message({message:"上传成功！",type:"success"}),document.getElementsByClassName("el-icon-close")[0].setAttribute("display","none")},handleError:function(e,t,a){this.$message({message:"上传失败！",type:"error"})},isSubmit:function(){return""!=this.form.name&&""!=this.form.scale&&""!=this.form.productIdentifier||(this.$message("有必填项没有填写，无法提交！"),!1)},handleSuccess1:function(e,t,a){this.form.img1=e.path,this.$message({message:"上传成功！",type:"success"}),document.getElementsByClassName("el-icon-close")[0].setAttribute("display","none")},submitUpload1:function(){this.$refs.upload1.submit()},handleClickSubmit:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,l,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isSubmit()){t.next=2;break}return t.abrupt("return");case 2:return a="role:"+e.form.relationApp,n={},n[a]={read:!0,write:!0},r={ACL:n,title:e.form.name,category:e.form.category.join("/"),scale:e.form.scale,productIdentifier:e.form.productIdentifier,copyright:e.form.copyright,desc:e.form.desc,logo:e.form.img,background:e.form.img1,userUnit:e.form.department,dashboard:""},""!=e.form.dashboard?r.dashboard="http://"+e.form.dashboard:r.dashboard="",t.next=9,Object(u["postProduct"])(r);case 9:l=t.sent,i=l.objectId,i&&e.addRelation(res.objectId,e.relationAppObjectId);case 12:case"end":return t.stop()}}),t)})))()},addRelation:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(p["postRelation"])({destClass:"Project",destId:e,destField:"app",srcClass:"App",srcId:t});case 2:r=n.sent,r?(a.$message({message:"添加部署成功！",type:"success"}),a.$router.push({path:"/roles/projectManagement"})):a.$message("部署失敗");case 4:case"end":return n.stop()}}),n)})))()},handleClickUpdate:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isSubmit()){t.next=2;break}return t.abrupt("return");case 2:return a="role:"+e.form.relationApp,n={},n[a]={read:!0,write:!0},r={ACL:n,title:e.form.name,category:e.form.category.join("/"),scale:e.form.scale,productIdentifier:e.form.productIdentifier,copyright:e.form.copyright,desc:e.form.desc,logo:e.form.img,background:e.form.img1,userUnit:e.form.department,dashboard:""},""!=e.form.dashboard?r.dashboard="http://"+e.form.dashboard:r.dashboard="",t.next=9,Object(u["putProduct"])(e.argu.objectId,r);case 9:l=t.sent,l&&(e.$message({message:"修改成功！",type:"success"}),e.$router.push({path:"/roles/projectManagement"}));case 11:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.addchannel.applicationtText=e.name},Industry:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,e.form.options=[],t.next=4,Object(o["queryDict"])({limit:1e3,where:{"data.key":"category"}});case 4:a=t.sent,a&&(n=a.results,n.map((function(t){var a={};a.value=t.data.CategoryName,a.label=t.data.CategoryName,a.id=t.data.Id,a.parentid=t.data.SuperId,e.form.options.push(a)})));case 6:case"end":return t.stop()}}),t)})))()},open12:function(){this.Notification=this.$notify({title:"面板预览",dangerouslyUseHTMLString:!0,duration:0,type:"success",message:"<div><iframe\n              src='http://".concat(this.form.dashboard,'\'\n              width="1000"\n              height="400"\n              frameborder="0"\n    ></iframe></div>')})}}},h=m,f=(a("1be0"),a("3e38"),a("2877")),g=Object(f["a"])(h,n,r,!1,null,"583f4c9b",null);t["default"]=g.exports},5507:function(e,t,a){},"6cde":function(e,t,a){},"789f":function(e,t,a){"use strict";a.r(t);var n=[{columns:["clientid","username","event","id","payload","peerhost","qos","timestamp","topic","node"],description:{en:"message publish",zh:"消息发布"},event:"message.publish",sql_example:"SELECT payload.msg as msg FROM \"message.publish\" WHERE topic =~ 't/#' and msg = 'hello'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic:"t/a",qos:1,payload:'{"msg": "hello"}'},title:{en:"message publish",zh:"消息发布"}},{columns:["clientid","username","event","auth_result","mountpoint","id","payload","peerhost","topic","qos","timestamp","node"],description:{en:"message delivered",zh:"消息投递"},event:"message.delivered",sql_example:"SELECT payload.msg as msg FROM \"message.delivered\" WHERE topic =~ 't/#' and msg = 'hello'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic:"t/a",qos:1,payload:'{"msg": "hello"}'},title:{en:"message delivered",zh:"消息投递"}},{columns:["clientid","username","event","id","payload","peerhost","topic","qos","timestamp","node"],description:{en:"message acked",zh:"消息应答"},event:"message.acked",sql_example:"SELECT payload.msg as msg FROM \"message.acked\" WHERE topic =~ 't/#' and msg = 'hello'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic:"t/a",qos:1,payload:'{"msg": "hello"}'},title:{en:"message acked",zh:"消息应答"}},{columns:["clientid","username","event","id","payload","peerhost","qos","timestamp","topic","node"],description:{en:"message dropped",zh:"消息丢弃"},event:"message.dropped",sql_example:"SELECT payload.msg as msg FROM \"message.dropped\" WHERE topic =~ 't/#' and msg = 'hello'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic:"t/a",qos:1,payload:'{"msg": "hello"}'},title:{en:"message dropped",zh:"消息丢弃"}},{columns:["clientid","username","event","auth_result","clean_start","connack","connected_at","is_bridge","keepalive","mountpoint","peerhost","proto_ver","timestamp","node"],description:{en:"client connected",zh:"连接建立"},event:"client.connected",sql_example:'SELECT * FROM "client.connected"',test_columns:{clientid:"c_emqx",username:"u_emqx",auth_result:"success",peerhost:"127.0.0.1"},title:{en:"client connected",zh:"连接建立"}},{columns:["clientid","username","event","auth_result","mountpoint","peerhost","reason_code","timestamp","node"],description:{en:"client disconnected",zh:"连接断开"},event:"client.disconnected",sql_example:'SELECT * FROM "client.disconnected"',test_columns:{clientid:"c_emqx",username:"u_emqx",reason_code:"normal"},title:{en:"client disconnected",zh:"连接断开"}},{columns:["clientid","username","event","auth_result","mountpoint","peerhost","topic_filters","topic","qos","timestamp","node"],description:{en:"client subscribe",zh:"终端订阅"},event:"client.subscribe",sql_example:"SELECT * FROM \"client.subscribe\" WHERE topic =~ 't/#'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic_filters:[{topic:"t/a",qos:0},{topic:"t/b",qos:1}]},title:{en:"client subscribe",zh:"终端订阅"}},{columns:["clientid","username","event","auth_result","mountpoint","peerhost","topic_filters","topic","qos","timestamp","node"],description:{en:"client unsubscribe",zh:"终端取消订阅"},event:"client.unsubscribe",sql_example:"SELECT * FROM \"client.unsubscribe\" WHERE topic =~ 't/#'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic_filters:["t/a","t/b"]},title:{en:"client unsubscribe",zh:"终端取消订阅"}},{columns:["clientid","username","event","topic","qos","nl","rap","rc","rh","timestamp","node"],description:{en:"session subscribed",zh:"会话订阅完成"},event:"session.subscribed",sql_example:"SELECT * FROM \"session.subscribed\" WHERE topic =~ 't/#'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic:"t/a",qos:1},title:{en:"session subscribed",zh:"会话订阅完成"}},{columns:["clientid","username","event","topic","qos","nl","rap","rc","rh","timestamp","node"],description:{en:"session unsubscribed",zh:"会话取消订阅完成"},event:"session.unsubscribed",sql_example:"SELECT * FROM \"session.unsubscribed\" WHERE topic =~ 't/#'",test_columns:{clientid:"c_emqx",username:"u_emqx",topic:"t/a",qos:1},title:{en:"session unsubscribed",zh:"会话取消订阅完成"}}];t["default"]=n},"78c5":function(e,t,a){"use strict";a("3cde")},"79e2":function(e,t,a){},"88b5":function(e,t,a){},"8e1a":function(e,t,a){},"9c56":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"createResourcechannel"},[a("vab-input",{ref:"uploadFinish",on:{fileInfo:e.fileInfo}}),a("el-form",{ref:"addchannel",attrs:{rules:e.addrules,"label-width":"auto",model:e.addchannel,size:"mini"}},[a("div",{staticClass:"dialog-footer",staticStyle:{margin:"15px"}},[a("el-button",{on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.back"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addchannelForm("addchannel")}}},[e._v(" "+e._s(e.$translateTitle("developer.create"))+" ")])],1),a("el-row",[a("el-form-item",{attrs:{label:"通道类型",prop:"region"}},[a("el-select",{staticStyle:{display:"block"},attrs:{placeholder:"通道类型"},on:{change:e.removeauto},model:{value:e.addchannel.region,callback:function(t){e.$set(e.addchannel,"region",t)},expression:"addchannel.region"}},e._l(e.channelregion,(function(e,t){return a("el-option",{key:t,staticStyle:{display:"block"},attrs:{label:e.title.zh,value:e.cType}})})),1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name"}},[a("el-input",{staticStyle:{float:"left"},attrs:{placeholder:e.$translateTitle("developer.channelname"),autocomplete:"off"},model:{value:e.addchannel.name,callback:function(t){e.$set(e.addchannel,"name",t)},expression:"addchannel.name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"所属应用",prop:"applicationtText"}},[a("el-input",{attrs:{readonly:""},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.addchannel.applicationtText,callback:function(t){e.$set(e.addchannel,"applicationtText",t)},expression:"addchannel.applicationtText"}}),e.showTree?a("div",{staticClass:"device-tree"},[a("el-tree",{attrs:{"default-expand-all":"",data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1)],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"ico"!=t.showname,expression:"item.showname != 'ico'"}],attrs:{label:t.title.zh,required:t.required,prop:t.showname}},[a("el-tooltip",{attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(t.description.zh)+" ")]),a("i",{staticClass:"el-icon-question",staticStyle:{float:"left"}})]),"string"==t.type?a("el-input",{staticStyle:{width:"98%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}}):"integer"==t.type?a("el-input",{staticStyle:{width:"98%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}}):"ico"==t.showname?a("el-image",{staticStyle:{display:"none",width:"98%"}}):"boolean"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"98%"},attrs:{readonly:""},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},[a("el-option",{attrs:{value:!0,label:"是"}}),a("el-option",{attrs:{value:!1,label:"否"}})],1):"enum"==t.type?a("el-select",{staticStyle:{width:"98%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},e._l(t.enum,(function(e,n){return a("el-option",{key:n,attrs:{label:t.enum[n],value:t.enum[n]}})})),1):e._e()],1)],1)})),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{rows:3,placeholder:e.$translateTitle("developer.describe"),autocomplete:"off",type:"textarea"},model:{value:e.addchannel.desc,callback:function(t){e.$set(e.addchannel,"desc",t)},expression:"addchannel.desc"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-row",{staticStyle:{width:"100%","max-height":"500px",margin:"0","overflow-x":"hidden","overflow-y":"scroll","line-height":"30px","text-align":"center"},attrs:{gutter:24}},e._l(e.channelregion,(function(t,n){return a("el-col",{key:n,staticStyle:{padding:"10px",margin:"0px",cursor:"pointer"},attrs:{span:4}},[a("el-card",{staticClass:"box-card",style:{color:e.addchannel.region==t.cType?"#00bad0":"#c0c4cc"},attrs:{shadow:e.addchannel.region==t.cType?"always":"hover",size:"mini"}},[a("div",{staticClass:"text item",on:{click:function(a){return e.setCard(t.cType)}}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:6}},[a("img",{staticClass:"image",staticStyle:{width:"50px",height:"50px"},attrs:{src:t.params.ico.default?t.params.ico.default:"http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/logo/logo.png"}})]),a("el-col",{attrs:{span:18}},[a("span",[a("p",[a("el-tag",{staticStyle:{float:"left",color:"black","text-align":"left",background:"#fff"}},[e._v(" "+e._s(t.cType)+" ")])],1),a("p",{attrs:{title:t.title.zh}},[e._v(" "+e._s(t.title.zh)+" ")])])])],1)],1)])],1)})),1)],1)],2)],1)],1)},r=[],l=a("1da1"),i=a("5530"),s=(a("b0c0"),a("d3b7"),a("25f0"),a("4e82"),a("d81d"),a("159b"),a("96cf"),a("1b07")),o=a("89e8"),c=a("5880"),d={name:"CreateResourcechannel",components:{},data:function(){return{channelregion:[],defaultProps:{children:"children",label:"label"},resourceid:"",showTree:!1,allApps:[],arrlist:[],addrules:{applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择通道类型",trigger:"change"}]},addchannel:{name:"",region:""}}},computed:Object(i["a"])({},Object(c["mapGetters"])({roleTree:"user/roleTree"})),mounted:function(){this.getResource()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:Object(i["a"])(Object(i["a"])({},Object(c["mapActions"])({addVisitedRoute:"tabs/addVisitedRoute",delVisitedRoute:"tabs/delVisitedRoute",delOthersVisitedRoutes:"tabs/delOthersVisitedRoutes",delLeftVisitedRoutes:"tabs/delLeftVisitedRoutes",delRightVisitedRoutes:"tabs/delRightVisitedRoutes",delAllVisitedRoutes:"tabs/delAllVisitedRoutes"})),{},{initFrom:function(){this.addchannel={},this.channelForm=!1,this.$refs["addchannel"].resetFields(),this.resourceid=""},uploadCkick:function(e,t){this.channeindex=t,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click"))},fileInfo:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.channelregion[t.channeindex].params.ico.default=e.url,a.next=3,Object(s["putResourceTypes"])(t.channelregion);case 3:a.sent;case 4:case"end":return a.stop()}}),a)})))()},handleClose:function(){this.handleTabRemove()},addchannelForm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={};for(var n in t.addchannel)a[n]=t.addchannel[n];delete a.region,delete a.desc,delete a.type,delete a.isEnable,delete a.name;var r="role:"+t.addchannel.applicationtText,l={};l[r]={read:!0,write:!0};var i={ACL:l,config:a,name:t.addchannel.name,cType:t.addchannel.region,desc:t.addchannel.desc,isEnable:!1,status:"OFFLINE",type:t.addchannel.type.toString()};t.addchannelaxios(i)}else t.$message("有必填项未填")}))},setCard:function(e){this.removeauto(e)},orderObject:function(e){var t=[];for(var a in e)e[a].showname=a,t.push(e[a]);return t.sort(this.arrSort)},removeauto:function(e){var t=this,a={},n={applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择通道类型",trigger:"change"}]};if(""==this.resourceid?this.channelregion.map((function(r){r.cType==e&&(t.$forceUpdate(),t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(e){e.default?a[e.showname]=e.default:a[e.showname]="",e.required&&("string"==e.type||"integer"==e.type?n[e.showname]=[{required:!0,trigger:"blur"}]:n[e.showname]=[{required:!0,trigger:"change"}])})),a.region=e,a.desc="",a.name="",a.type=t.selectregion.type,a.isEnable=!1)})):this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.$forceUpdate(),t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(r){for(var l in t.channelrow.config)r.showname==l&&(a[r.showname]=t.channelrow.config[l]),r.required&&("string"==r.type||"integer"==r.type?n[r.showname]=[{required:!0,trigger:"blur"}]:n[r.showname]=[{required:!0,trigger:"change"}]),a.region=e,a.desc=t.channelrow.desc,a.name=t.channelrow.name,a.type=t.selectregion.type,a.isEnable=t.channelrow.isEnable})))})),this.channelrow)for(var r in this.channelrow.ACL)a.applicationtText=r?r.substr(5):"";this.addchannel=a,this.addchannel.region=e,this.addrules=n},addchannelaxios:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["postChannel"])(e).then((function(e){e&&(t.$message({type:"success",message:"编辑"==t.channelupdated?"编辑成功":"创建成功"}),t.addchannel={},t.channelForm=!1,t.resourceid="",t.handleTabRemove())}));case 2:case"end":return a.stop()}}),a)})))()},handleTabRemove:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$route.path,t.next=3,e.delVisitedRoute(a);case 3:e.$router.go(-1);case 4:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.$set(this.addchannel,"applicationtText",e.name),this.showTree=!this.showTree},clearValidate:function(e){this.$refs.addchannel.clearValidate("".concat(e))},getResource:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(s["resourceTypes"])();case 3:a=t.sent,a.forEach((function(e){e.params.ico||(e.params.ico={title:{en:"channel ICO",zh:"通道ICO"},description:{en:"channel ICO",zh:"通道ICO"},default:"http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/logo/logo.png"})})),e.channelregion=a,e.$nextTick((function(){e.initFrom()}));case 7:case"end":return t.stop()}}),t)})))()},onSubmit:function(){}})},u=d,p=(a("08dd"),a("2877")),m=Object(p["a"])(u,n,r,!1,null,"164b87fa",null);t["default"]=m.exports},"9c971":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dict"},[a("div",{staticClass:"dialog"},[a("el-dialog",{attrs:{"append-to-body":!0,visible:e.add_dict_dialog,"close-on-click-modal":!1,title:e.title_dict_dialog,width:"40%"},on:{"update:visible":function(t){e.add_dict_dialog=t},open:function(t){return e.opendialog("dictForm")}}},[a("el-form",{ref:"dictForm",staticClass:"dict_type",attrs:{model:e.addDictForm,rules:e.rules1,"label-width":"135px",size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionarytype"),prop:"templateId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:""!=e.editDictId,placeholder:e.$translateTitle("task.Select")},on:{change:e.selectChange},model:{value:e.addDictForm.templateId,callback:function(t){e.$set(e.addDictForm,"templateId",t)},expression:"addDictForm.templateId"}},e._l(e.dictRecord,(function(e){return a("el-option",{key:e.objectId,attrs:{label:e.data.name,value:e.objectId,disabled:"ALL"==e.data.name}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.dictionaryname"),title:e.$translateTitle("developer.dictionaryuniqueID"),prop:"key"}},[a("el-input",{attrs:{disabled:""!=e.editDictId},model:{value:e.addDictForm.key,callback:function(t){e.$set(e.addDictForm,"key",t)},expression:"addDictForm.key"}})],1)],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.title.zh,prop:t.name,required:t.required}},["Boolean"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"100%"},attrs:{readonly:""},model:{value:e.addDictForm[t.name],callback:function(a){e.$set(e.addDictForm,t.name,a)},expression:"addDictForm[item.name]"}},[a("el-option",{attrs:{value:!0,label:e.$translateTitle("product.yes")}}),a("el-option",{attrs:{value:!1,label:e.$translateTitle("product.no")}})],1):a("el-input",{model:{value:e.addDictForm[t.name],callback:function(a){e.$set(e.addDictForm,t.name,a)},expression:"addDictForm[item.name]"}})],1)],1)})),a("el-col",{staticStyle:{"z-index":"99999"},attrs:{span:12}},[a("el-form-item",{attrs:{rules1:[{required:!0,message:e.$translateTitle("product.pleaseselectyourapp"),trigger:"blur"}],label:e.$translateTitle("application.applicationtype")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.pleaseselectyourapp"),readonly:""},model:{value:e.addDictForm.applicationtText,callback:function(t){e.$set(e.addDictForm,"applicationtText",t)},expression:"addDictForm.applicationtText"}},[a("template",{slot:"append"},[a("i",{class:[e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{cursor:"pointer"},on:{click:function(t){e.showTree=!e.showTree}}})])],2),e.showTree?a("div",{staticClass:"device-tree"},[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1)],1),a("el-col",{staticStyle:{height:"47px"},attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.state"),prop:"enable"}},[a("el-radio",{attrs:{label:"1",border:""},model:{value:e.addDictForm.enable,callback:function(t){e.$set(e.addDictForm,"enable",t)},expression:"addDictForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]),a("el-radio",{attrs:{label:"2",border:""},model:{value:e.addDictForm.enable,callback:function(t){e.$set(e.addDictForm,"enable",t)},expression:"addDictForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.scrap"))+" ")])],1)],1)],2),a("el-form-item",{attrs:{label:e.$translateTitle("user.Remarks")}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:e.$translateTitle("concentrator.input")},model:{value:e.addDictForm.description,callback:function(t){e.$set(e.addDictForm,"description",t)},expression:"addDictForm.description"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini","label-width":"0px"}},[e.editDictId?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("dictForm")}}},[e._v(" "+e._s(e.$translateTitle("product.modify"))+" ")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("dictForm")}}},[e._v(" "+e._s(e.$translateTitle("product.createnow"))+" ")]),a("el-button",{on:{click:function(t){e.add_dict_dialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1)],1),a("a-drawer",{attrs:{visible:e.dict_temp_dialog,"close-on-click-modal":!1,title:e.title_temp_dialog,width:"60%"},on:{close:function(t){e.dict_temp_dialog=!e.dict_temp_dialog},open:function(t){return e.opendialog("dictTempForm")}}},[a("el-form",{ref:"dictTempForm",attrs:{model:e.dictTempForm,rules:e.rules,size:"mini"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$translateTitle("developer.dictionarytemplatename"),prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.name,callback:function(t){e.$set(e.dictTempForm,"name",t)},expression:"dictTempForm.name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$translateTitle("developer.dictionarytemplatetype"),prop:"cType"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.dictTempForm.cType,callback:function(t){e.$set(e.dictTempForm,"cType",t)},expression:"dictTempForm.cType"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$translateTitle("developer.dictionarytemplatestatus"),prop:"enable"}},[a("el-radio",{attrs:{label:"1",border:""},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]),a("el-radio",{attrs:{label:"0",border:""},model:{value:e.dictTempForm.enable,callback:function(t){e.$set(e.dictTempForm,"enable",t)},expression:"dictTempForm.enable"}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")])],1)],1)],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$translateTitle("developer.dictionarytemplatedata")}},[a("el-tabs",{model:{value:e.elactiveName,callback:function(t){e.elactiveName=t},expression:"elactiveName"}},[a("el-tab-pane",{attrs:{label:"Table",name:"Table"}},[a("el-button",{staticClass:"mt-3",attrs:{type:"primary",size:"small",icon:"el-icon-plus"},nativeOn:{click:function(t){return e.addRow(e.dictTempForm.params)}}},[e._v(" "+e._s(e.$translateTitle("product.newlyadded"))+" ")]),a("el-table",{staticStyle:{width:"100%","text-align":"center"},attrs:{data:e.dictTempForm.params,height:"300"}},[a("el-table-column",{attrs:{prop:"name",label:e.$translateTitle("equipment.name")}}),a("el-table-column",{attrs:{prop:"type",label:e.$translateTitle("rule.Type")}}),a("el-table-column",{attrs:{prop:"order",label:e.$translateTitle("equipment.serialnumber")}}),a("el-table-column",{attrs:{prop:"default",label:e.$translateTitle("equipment.defaultvalue")},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.default&&"Boolean"==t.row.type?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):0==t.row.default&&"Boolean"==t.row.type?a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")]):"Number"==t.row.type?a("span",[e._v(" "+e._s(t.row.default)+" ")]):a("span",[e._v(e._s(t.row.default))])]}}])}),a("el-table-column",{attrs:{prop:"required",label:e.$translateTitle("product.isitrequired")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.required?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])]}}])}),a("el-table-column",{attrs:{prop:"description",label:e.$translateTitle("product.chinesetitle")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title.zh)+" ")]}}])}),a("el-table-column",{attrs:{prop:"description",label:e.$translateTitle("product.englishtitle")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title.en)+" ")]}}])}),a("el-table-column",{attrs:{prop:"description",label:e.$translateTitle("product.chinesedescription")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description.zh)+" ")]}}])}),a("el-table-column",{attrs:{prop:"description",label:e.$translateTitle("product.englishdescription")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description.en)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("task.Operation"),width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger",plain:"",title:e.$translateTitle("task.Delete")},nativeOn:{click:function(a){return e.delRow(t.$index,e.dictTempForm.params)}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")]),a("el-button",{attrs:{size:"mini",type:"info",plain:"",title:e.$translateTitle("task.Edit")},nativeOn:{click:function(a){return e.editRow(t.row,t.$index,e.dictTempForm.params)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"Json",name:"Json"}},[a("vab-json-editor",{attrs:{mode:"code",lang:"zh"},on:{"json-change":e.onJsonChange,"has-error":e.onError},model:{value:e.dictTempForm.params,callback:function(t){e.$set(e.dictTempForm,"params",t)},expression:"dictTempForm.params"}})],1)],1)],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:e.$translateTitle("developer.Pleaseenteradescription")},model:{value:e.dictTempForm.description,callback:function(t){e.$set(e.dictTempForm,"description",t)},expression:"dictTempForm.description"}})],1),a("el-form-item",{staticStyle:{"text-align":"center"},attrs:{size:"mini"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onJsonSave("dictTempForm")}}},[e._v(" "+e._s(e.$translateTitle("application.submit"))+" ")]),a("el-button",{on:{click:function(t){e.dict_temp_dialog=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")])],1)],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.edit_dict_temp_dialog,title:e.title_dict_edit_dialog,"close-on-click-modal":!1,size:"mini"},on:{"update:visible":function(t){e.edit_dict_temp_dialog=t},open:function(t){return e.opendialog("tempparams")}}},[a("el-form",{ref:"tempparams",staticClass:"demo-ruleForm",attrs:{model:e.tempparams,size:"mini","status-icon":"","label-width":"70px"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.name"),"label-width":"50px",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.name,callback:function(t){e.$set(e.tempparams,"name",t)},expression:"tempparams.name"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:e.$translateTitle("rule.Type"),"label-width":"50px",prop:"type"}},[a("el-select",{attrs:{placeholder:e.$translateTitle("task.Select")},on:{change:e.tempTypeChange},model:{value:e.tempparams.type,callback:function(t){e.$set(e.tempparams,"type",t)},expression:"tempparams.type"}},e._l(e.dictOptions,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{attrs:{label:e.$translateTitle("equipment.serialnumber"),"label-width":"50px",prop:"order"}},[a("el-input",{model:{value:e.tempparams.order,callback:function(t){e.$set(e.tempparams,"order",e._n(t))},expression:"tempparams.order"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:e.$translateTitle("product.mustfill"),"label-width":"50px"}},[a("el-radio",{attrs:{label:!0,border:""},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]),a("el-radio",{attrs:{label:!1,border:""},model:{value:e.tempparams.required,callback:function(t){e.$set(e.tempparams,"required",t)},expression:"tempparams.required"}},[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])],1)],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.chinesetitle"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.title.zh,callback:function(t){e.$set(e.tempparams.title,"zh",t)},expression:"tempparams.title.zh"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.englishtitle"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.title.en,callback:function(t){e.$set(e.tempparams.title,"en",t)},expression:"tempparams.title.en"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("equipment.defaultvalue"),prop:"default"}},["Boolean"==e.tempparams.type?a("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}},[a("el-option",{attrs:{value:!0,label:e.$translateTitle("product.yes")}}),a("el-option",{attrs:{value:!1,label:e.$translateTitle("product.no")}})],1):"Number"==e.tempparams.type?a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",e._n(t))},expression:"tempparams.default"}}):a("el-input",{model:{value:e.tempparams.default,callback:function(t){e.$set(e.tempparams,"default",t)},expression:"tempparams.default"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.chinesedescription"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.description.zh,callback:function(t){e.$set(e.tempparams.description,"zh",t)},expression:"tempparams.description.zh"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.englishdescription"),prop:"title"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.tempparams.description.en,callback:function(t){e.$set(e.tempparams.description,"en",t)},expression:"tempparams.description.en"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitFormTempDict()}}},[e._v(" "+e._s(e.$translateTitle("application.submit"))+" ")])],1)],1)],1)],1),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("developer.dictionarytemplatemanagement"),name:"字典模板管理"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$translateTitle("developer.pleaseenterdictionarytemplatename"),size:"mini",clearable:""},model:{value:e.search_dict,callback:function(t){e.search_dict=t},expression:"search_dict"}}),a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.searchDict(e.search_dict)}}},[e._v(" "+e._s(e.$translateTitle("task.Search"))+" ")]),a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.createDictTemp}},[e._v(" "+e._s(e.$translateTitle("developer.createdictionarytemplate"))+" ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},data:e.dictRecord,"row-class-name":e.tableRowClassName}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.indexes"),type:"index",width:"50"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatenumber"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.objectId?[e._v(" "+e._s(t.row.objectId)+" ")]:void 0}}],null,!0)}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatename"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.data.name)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatetype"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.data.cType)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytemplatestatus"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.data.enable?a("el-tag",{attrs:{type:"success"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-tag",{attrs:{type:"warning"}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.data.description)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("task.Operation"),width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return t.row.objectId?[a("el-button",{attrs:{size:"mini",type:"success",plain:""},on:{click:function(a){return e.editDictTemp(t.row)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),"0"==t.row.data.enable?a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return e.disabledAllDict(t.row,"1")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return e.disabledAllDict(t.row,"0")}}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){return e.deleteDict(t.row,"字典模板")}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]:void 0}}],null,!0)})],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px","text-align":"center"}},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.length1,total:e.total1,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.channelSizeChange1,"current-change":e.channelCurrentChange1}})],1)],1),a("el-tab-pane",{attrs:{label:e.$translateTitle("developer.dictionarymanagement"),name:"字典管理"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{size:"mini",placeholder:e.$translateTitle("task.Select")},on:{change:e.selectDictChange},model:{value:e.dictType,callback:function(t){e.dictType=t},expression:"dictType"}},e._l(e.dictRecordOpt,(function(e){return a("el-option",{key:e.data.name,attrs:{label:e.data.name,value:e.objectId}})})),1),a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-plus"},on:{click:e.showDictDialog}},[e._v(" "+e._s(e.$translateTitle("developer.createdictionary"))+" ")]),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.isALL,expression:"isALL"},{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},data:e.dictData,"row-class-name":e.tableRowClassName,"element-loading-text":e.$translateTitle("developer.loadingdesperately"),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",border:"",stripe:""}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.indexes"),type:"index",width:"50"}}),a("el-table-column",{attrs:{prop:"key",label:e.$translateTitle("developer.dictionaryname")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.key)+" ")]}}])}),a("el-table-column",{attrs:{prop:"type",label:e.$translateTitle("developer.dictionarynumber")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.objectId)+" ")]}}])}),a("el-table-column",{attrs:{prop:"type",label:e.$translateTitle("developer.dictionarytype")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.data.templateName)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("concentrator.status")},scopedSlots:e._u([{key:"default",fn:function(t){return["1"==t.row.data.enable?a("el-tag",{attrs:{type:"success"}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-tag",{attrs:{type:"warning"}},[e._v(" "+e._s(e.$translateTitle("developer.scrap"))+" ")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("user.Remarks")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.data.description)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("product.commandoperation"),width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"success",plain:""},on:{click:function(a){return e.editAllDict(t.row)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),"0"==t.row.data.enable?a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return e.disabledAllDict(t.row,"1")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return e.disabledAllDict(t.row,"0")}}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){return e.deleteDict(t.row,"字典")}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:!e.isALL,expression:"!isALL"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"filterObj",staticClass:"filter_obj",staticStyle:{width:"100%"},attrs:{"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},data:e.dictList,"row-class-name":e.tableRowClassName,"element-loading-text":e.$translateTitle("developer.loadingdesperately"),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)",border:""}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.dictionarytype"),width:"150",prop:"templateName"}}),e._l(e.dialogtempconfig,(function(t,n){return["Boolean"==t.type?a("el-table-column",{key:n,attrs:{label:t.title.zh,prop:t.name},scopedSlots:e._u([{key:"default",fn:function(n){return[n.row[t.name]?a("span",[e._v(" "+e._s(e.$translateTitle("product.yes"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("product.no"))+" ")])]}}],null,!0)}):a("el-table-column",{key:n,attrs:{label:t.title.zh,prop:t.name}})]})),a("el-table-column",{attrs:{label:e.$translateTitle("product.commandoperation"),fixed:"right",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"success",plain:""},on:{click:function(a){return e.editDict(t.row)}}},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),"0"==t.row.enable?a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return e.disabledDict(t.row,"1")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(a){return e.disabledDict(t.row,"0")}}},[e._v(" "+e._s(e.$translateTitle("developer.disable"))+" ")]),a("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(a){return e.deleteDict(t.row,"字典")}}},[e._v(" "+e._s(e.$translateTitle("task.Delete"))+" ")])]}}])})],2),e.isALL?a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px","text-align":"center"}},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.length,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.channelSizeChange,"current-change":e.channelCurrentChange}})],1):e._e()],1)],1)],1)},r=[],l=a("2909"),i=a("1da1"),s=a("5530"),o=(a("96cf"),a("4de4"),a("caad"),a("2532"),a("d81d"),a("b0c0"),a("a434"),a("99af"),a("a8be")),c=a("5880"),d=a("1b07"),u={name:"Dict",components:{},data:function(){return{queryid:this.$route.query.dictid,arrlist:[],addDictForm:{templateId:"",key:""},rules:{},rules1:{},loading:!1,defaultProps:{children:"children",label:"label"},count:0,start:0,total:0,length:10,count1:0,start1:0,total1:0,length1:10,isALL:!0,filterObj:[],tempObjectId:"",dictType:"ALL",allApps:[],showTree:!1,editIndexId:void 0,editDictId:"",editDictTempId:"",infoData:new Date,elactiveName:"Table",activeName:"字典模板管理",title_dict_edit_dialog:"新增字典数据",title_temp_dialog:"新增字典模板",title_dict_dialog:"新增字典",search_dict:"",add_dict_dialog:!1,dict_temp_dialog:!1,edit_dict_temp_dialog:!1,dialogtempconfigVisible:!1,dialogtempconfig:[],dictData:[],dictRecord:[],listLoading:!1,dictRecordOpt:[],dictOptions:["String","Boolean","Number"],dictForm:{type:"",name:"",nameEncrypt:"",needReply:"",enable:"",description:"",tempconfig:[]},tempparams:{name:"",type:"",order:0,title:{en:"",zh:""},default:5,required:!1,description:{en:"",zh:""}},dictList:[],dictTempForm:{name:"",cType:"",enable:"1",description:"",params:[]},formLabelWidth:"120px"}},computed:Object(s["a"])(Object(s["a"])({},Object(c["mapGetters"])({roleTree:"user/roleTree"})),{},{dragOptions:function(){return{animation:600,group:"description"}},finallyColumns:function(){var e=this;return this.columns.filter((function(t){return e.checkList.includes(t.label)}))}}),mounted:function(){this.getDictData(),this.getDictRecord(),this.dialogType()},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{opendialog:function(e){var t=this;this.$nextTick((function(){t.$refs[e].clearValidate()}))},selectDictChange:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("0"!=e){a.next=6;break}t.listLoading=!0,t.getDictRecord(),t.isALL=!0,a.next=18;break;case 6:return Object(o["getDict"])(e).then((function(e){t.dialogtempconfig=e.data.params})),t.listLoading=!0,n={order:"-createdAt",limit:100,skip:0,where:{type:e}},a.next=11,Object(o["queryDict"])(n);case 11:r=a.sent,l=r.results,t.isALL=!1,t.filterObj=l,t.listLoading=!1,t.dictList=[],t.filterObj.map((function(e){var a={objectId:e.objectId};for(var n in e.data)a[n]=e.data[n];t.dictList.push(a)}));case 18:case"end":return a.stop()}}),a)})))()},dialogType:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(d["resourceTypes"])();case 3:a=t.sent,e.channelregion=a;case 5:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.addDictForm.applicationtText=e.name},editAllDict:function(e){this.editDictId=e.objectId,this.selectChange(e.type),this.addDictForm=e.data,this.addDictForm.type=e.type,this.add_dict_dialog=!0,this.title_dict_dialog="编辑字典"},editDict:function(e){this.editDictId=e.objectId,this.selectChange(e.templateId),this.addDictForm=e,this.add_dict_dialog=!0,this.title_dict_dialog="编辑字典"},tempTypeChange:function(e){this.tempparams.default="Boolean"==e||("Number"==e?0:void 0)},selectChange:function(e){var t=this,a={};Object(o["getDict"])(e).then((function(n){t.listLoading=!0,t.arrlist=n.data.params;var r={key:[{required:!0,message:"请输入字典名称",trigger:"blur"}],templateId:[{required:!0,message:"请选择字典类型",trigger:"blur"}],rolesObj:[{required:!0,message:"请选择所属应用",trigger:"change"}]};t.arrlist.map((function(e){e.default?a[e.name]=e.default:a[e.name]="",e.required&&("Boolean"==e.type?r[e.name]=[{required:!0,message:"请选择"+e.title.zh,trigger:"change"}]:r[e.name]=[{required:!0,message:"请输入"+e.title.zh,trigger:"blur"}])})),t.rules1=r,t.editDictId||(t.addDictForm=a),t.addDictForm.templateId=e,t.addDictForm.templateName=n.data.name,t.listLoading=!1}))},submitFormTempDict:function(){this.edit_dict_temp_dialog=!1,void 0!=this.editIndexId?(this.dictTempForm.params[this.editIndexId]=this.tempparams,this.$message("编辑成功")):(this.dictTempForm.params.push(this.tempparams),this.$message("新增成功"))},addRow:function(e){this.editIndexId=void 0,this.title_dict_edit_dialog="新增字典数据",this.edit_dict_temp_dialog=!0,this.tempparams={name:"",type:"",order:0,title:{en:"",zh:""},default:0,required:!1,description:{en:"",zh:""}}},delRow:function(e,t){t.splice(e,1)},editRow:function(e,t,a){this.editIndexId=t,this.title_dict_edit_dialog="修改字典数据",this.edit_dict_temp_dialog=!0,this.tempparams=e},clearFormValidate:function(e){void 0!==this.$refs[e]&&this.$refs[e].resetFields()},onError:function(){this.$message("非Json数据类型")},onJsonChange:function(){},onJsonSave:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.editDictTempId?t.put_Dict_temp(t.editDictTempId,t.dictTempForm):t.addDict_temp(t.dictTempForm)}))},tableRowClassName:function(e){e.row;var t=e.rowIndex;return 1===t?"warning-row":3===t?"success-row":""},searchDict:function(e){this.queryid="",this.getDictData()},createDictTemp:function(){this.dict_temp_dialog=!0,this.editDictTempId="",this.title_temp_dialog="创建字典模板",this.dictTempForm={name:"",cType:"",enable:"1",description:"",params:[]},this.rules={name:[{required:!0,message:"请输入字典模板名称",trigger:"blur"}],cType:[{required:!0,message:"请输入字典模板类型",trigger:"blur"}],enable:[{required:!0,message:"请选择状态",trigger:"change"}]}},detailsTemp:function(e){alert(JSON.stringify(e))},showDictDialog:function(){this.add_dict_dialog=!0,this.title_dict_dialog="新增字典",this.editDictId="",this.addDictForm={},this.arrlist=[],this.rules1={key:[{required:!0,message:"请输入字典名称",trigger:"blur"}],templateId:[{required:!0,message:"请选择字典类型",trigger:"blur"}],rolesObj:[{required:!0,message:"请选择所属应用",trigger:"change"}]}},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){t.addDictForm.applicationtText?e&&(t.editDictId?t.put_Dict(t.editDictId,t.addDictForm):t.addDict(t.addDictForm)):t.$message("请选择所属应用")}))},addDict_temp:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={data:e,ACL:t.$aclObj,key:e.name,type:"dict_template"},a.next=3,Object(o["postDict"])(n);case 3:r=a.sent,void 0!=r.createdAt?(t.$message("创建成功"),t.dict_temp_dialog=!1,t.getDictData()):137==r.code?t.$message("字典名称重复"):t.$message("创建失败");case 5:case"end":return a.stop()}}),a)})))()},addDict:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,l,i,s,c;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(r in n={},e.templateTypekey="dict_template",e)n[r]=e[r];return l="role:"+e.applicationtText,i={},i[l]={read:!0,write:!0},s={data:n,ACL:i,key:e.key,type:e.templateId},a.next=9,Object(o["postDict"])(s);case 9:c=a.sent,c&&(t.$message("创建成功"),t.add_dict_dialog=!1,t.dictType=e.templateName,t.selectDictChange(e.templateId));case 11:case"end":return a.stop()}}),a)})))()},editDictTemp:function(e){this.editDictTempId=e.objectId,this.dictTempForm=e.data;var t=e.data.params,a=void 0===t?{}:t;this.dictTempForm.params=a,this.dict_temp_dialog=!0,this.title_temp_dialog="编辑字典模板"},put_Dict_temp:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,l,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={data:t,key:t.key},n.next=3,Object(o["putDict"])(e,r);case 3:l=n.sent,i=l.updatedAt,void 0!=i?(a.getDictData(),a.dict_temp_dialog=!1,a.$message("字典数据更新成功")):a.$message("字典数据更新失败");case 6:case"end":return n.stop()}}),n)})))()},put_Dict:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,l,i,s,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:for(l in r={},t)r[l]=t[l];return i={data:r},n.next=5,Object(o["putDict"])(e,i);case 5:s=n.sent,c=s.updatedAt,c?(a.dictType=t.templateName,a.selectDictChange(t.templateId),a.add_dict_dialog=!1,a.$message("字典数据更新成功")):a.$message("字典数据更新失败");case 8:case"end":return n.stop()}}),n)})))()},disabledDict:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,l,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.enable=t,r={key:e.key,data:e},n.next=4,Object(o["putDict"])(e.objectId,r);case 4:l=n.sent,i=l.updatedAt,i?a.$message("字典状态设置成功"):a.$message("字典状态设置失败");case 7:case"end":return n.stop()}}),n)})))()},disabledAllDict:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,l,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.data.enable=t,r={data:e.data},n.next=4,Object(o["putDict"])(e.objectId,r);case 4:l=n.sent,i=l.updatedAt,i?a.$message("字典状态设置成功"):a.$message("字典状态设置失败");case 7:case"end":return n.stop()}}),n)})))()},deleteDict:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.$del_object("Dict",e.objectId);case 2:r=n.sent,r?("字典"==t?(a.selectDictChange(e.templateId),a.getDictRecord()):(a.selectDictChange("0"),a.getDictData()),a.$message(t+"删除成功")):a.$message(t+"删除失败");case 4:case"end":return n.stop()}}),n)})))()},getDictData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,n={order:"-createdAt",count:"objectId",limit:e.length,skip:e.start,where:{type:"dict_template"}},e.queryid&&(n.where["objectId"]=e.queryid),e.search_dict&&(n.where["data.name"]=e.search_dict),t.next=6,Object(o["queryDict"])(n);case 6:r=t.sent,i=r.results,s=r.count,e.total1=s,e.dictRecordOpt=[],e.dictRecord=i,e.queryid&&(e.search_dict=e.dictRecord[0].data.name),e.listLoading=!1,(a=e.dictRecordOpt).push.apply(a,[{data:{name:"ALL"},objectId:"0"}].concat(Object(l["a"])(i)));case 15:case"end":return t.stop()}}),t)})))()},channelSizeChange1:function(e){this.length1=e,this.getDictData()},channelSizeChange:function(e){this.length=e,this.getDictRecord()},channelCurrentChange1:function(e){this.start1=(e-1)*this.length1,this.getDictData()},channelCurrentChange:function(e){this.start=(e-1)*this.length,this.getDictRecord()},getDictRecord:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.listLoading=!0,a={order:"-createdAt",count:"objectId",limit:e.length,skip:e.start,where:{"data.templateTypekey":"dict_template"}},t.next=4,Object(o["queryDict"])(a);case 4:n=t.sent,r=n.results,l=n.count,e.total=l,e.listLoading=!1,e.dictData=r;case 10:case"end":return t.stop()}}),t)})))()}}},p=u,m=(a("3e1f"),a("2877")),h=Object(m["a"])(p,n,r,!1,null,"2fc8b45e",null);t["default"]=h.exports},c4b2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"instruct"},[a("div",[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",[a("el-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入指令名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Instruct(0)}}},[e._v("查询")])],1)],1)],1),a("div",{staticClass:"instruct_button"},[a("div",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.dialogBtn_em("form","3",e.form)}}},[e._v(" 新增指令 ")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.deleteAll}},[e._v(" 删 除 ")])],1),a("div",[a("el-button",{attrs:{type:"success",size:"small"}},[e._v("启 用")]),a("el-button",{attrs:{type:"warning",size:"small"}},[e._v("禁 用")])],1)]),a("div",{staticClass:"instruct_table"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.instructData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"指令名称",align:"center",sortable:"",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),a("el-table-column",{attrs:{label:"指令类型",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["Read"==t.row.op?a("el-tag",{attrs:{type:"primary"}},[e._v("读")]):a("el-tag",{attrs:{type:"success"}},[e._v("写")])]}}])}),a("el-table-column",{attrs:{label:"指令标识",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.di))]}}])}),a("el-table-column",{attrs:{label:"指令序号",align:"center",prop:"order"}}),a("el-table-column",{attrs:{label:"超时时长",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.duration+"秒")+" ")]}}])}),a("el-table-column",{attrs:{label:"子网编号",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.pn))]}}])}),a("el-table-column",{attrs:{label:"生效轮次",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.rotation)+" ")]}}])}),a("el-table-column",{attrs:{label:"是否启用",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enable?a("el-tag",{attrs:{type:"success"}},[e._v("是")]):a("el-tag",{attrs:{type:"danger"}},[e._v("否")])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.dialogBtn_em("","2",t.row)}}},[e._v(" 编 辑 ")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteInstruct(t.row.objectId)}}},[e._v(" 删 除 ")])]}}])})],1),a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"page-sizes":[10,20,30,40],"page-size":e.pagesize,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.dialogTitle+"指令",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},open:e.openDialog}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formrule,size:"small"}},[a("h4",[e._v("  指令信息")]),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"指令名称",prop:"name"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入指令名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"操作类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择操作类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{attrs:{label:"读",value:"r"}}),a("el-option",{attrs:{label:"写",value:"w"}})],1)],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"是否启用",prop:"enable"}},[a("el-radio-group",{model:{value:e.form.enable,callback:function(t){e.$set(e.form,"enable",t)},expression:"form.enable"}},[a("el-radio",{attrs:{label:!0}},[e._v("是")]),a("el-radio",{attrs:{label:!1}},[e._v("否")])],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"指令指标",prop:"pointer"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入指令指标"},model:{value:e.form.pointer,callback:function(t){e.$set(e.form,"pointer",t)},expression:"form.pointer"}})],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"指令序号",prop:"order"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入指令序号"},model:{value:e.form.order,callback:function(t){e.$set(e.form,"order",t)},expression:"form.order"}})],1),a("p",{staticStyle:{"padding-left":"125px","font-size":"12px","line-height":"20px"}},[e._v(" 1. 指令序号相同,会作为同一组消息发送 "),a("br"),e._v(" 2. 消息的发送顺序按照指令序号排序 ")])],1)],1),a("h4",[e._v("  指令下发策略")]),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"超时时长",prop:"duration"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入超时时长"},model:{value:e.form.duration,callback:function(t){e.$set(e.form,"duration",e._n(t))},expression:"form.duration"}},[a("template",{slot:"append"},[e._v("秒")])],2)],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"生效轮次",prop:"rotation"}},[a("el-select",{attrs:{filterable:"",clearable:"","allow-create":"","default-first-option":"",placeholder:"请选择生效轮次"},model:{value:e.form.rotation,callback:function(t){e.$set(e.form,"rotation",t)},expression:"form.rotation"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("p",{staticStyle:{position:"absolute",top:"40px",margin:"0","font-size":"12px",color:"black"}},[e._v(" 例如:1,3,5,8;(可选可自主填写)(注意:逗号为英文逗号) ")])],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"子网编号",prop:"subnet"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入子网编号"},model:{value:e.form.subnet,callback:function(t){e.$set(e.form,"subnet",t)},expression:"form.subnet"}})],1),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"发送间隔",prop:"interval"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入发送间隔"},model:{value:e.form.interval,callback:function(t){e.$set(e.form,"interval",e._n(t))},expression:"form.interval"}},[a("template",{slot:"append"},[e._v("秒")])],2)],1)],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.check("form")}}},[e._v("确 定")])],1)],1)],1)},r=[],l=a("1da1"),i=(a("96cf"),a("b0c0"),a("d81d"),a("926a"),a("e0e9")),s={name:"Instruct",props:{productId:{type:String,default:""},devicesId:{type:String,default:""}},data:function(){return{formInline:{name:""},options:[{value:"first",label:"第一轮"},{value:"last",label:"最后一轮"},{value:"all",label:"全部"}],instructData:[],multipleTable:[],pagesize:10,start:0,total:0,dialogFormVisible:!1,formLabelWidth:"120px",form:{name:"",pointer:"",type:"",enable:"",duration:"",order:"",interval:"",rotation:"",subnet:""},formrule:{duration:[{required:!0,message:"请输入",trigger:"blur"}],interval:[{required:!0,message:"请输入",trigger:"blur"}],name:[{required:!0,message:"指标名称不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择操作类型",trigger:"blur"}],enable:[{required:!0,message:"指标是否启用不能为空",trigger:"change"}],order:[{required:!0,message:"指标序号不能为空",trigger:"blur"}],rotation:[{required:!0,message:"生效轮次不能为空",trigger:"change"}],subnet:[{required:!0,message:"子网编号不能为空",trigger:"blur"}],pointer:[{required:!0,message:"指令指标不能为空",trigger:"blur"}]},instructid:"",dialogTitle:"新增"}},watch:{dialogFormVisible:{handler:function(e){e||this.$refs.form.resetFields()},deep:!0},devicesId:{handler:function(e){},deep:!0}},mounted:function(){this.Instruct()},updated:function(){},methods:{dialogClosed:function(){this.dialogFormVisible=!1},openDialog:function(e,t,a){var n=this;this.$nextTick((function(){switch(n.$refs[e]&&n.$refs[e].resetFields(),t){case"2":n.dialogTitle="编辑",n.form=a;break;case"3":n.dialogTitle="添加";break;default:break}}))},Instruct:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r,l,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return 0==e&&(t.start=0),n={where:{device:t.devicesId},skip:t.start,limit:t.pagesize,order:"-createdAt",count:"objectId"},t.formInline.name&&(n.where.name=t.formInline.name),a.next=5,Object(i["queryIndustry"])(n);case 5:r=a.sent,l=r.count,s=r.results,t.total=l,t.instructData=s;case 10:case"end":return a.stop()}}),a)})))()},addInstruct:function(){this.dialogFormVisible=!0,this.$refs.form.resetFields()},check:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(a){var n,r,l,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={className:"Product",objectId:t.productId,__type:"Pointer"},r={className:"Device",objectId:t.devicesId,__type:"Pointer"},!a){e.next=17;break}if(l={device:r,product:n,name:t.form.name,enable:t.form.enable,op:t.form.type,rotation:t.form.rotation,duration:t.form.duration,order:t.form.order,interval:t.form.interval,di:t.form.pointer,pn:t.form.subnet,devaddr:t.form.lowerhair},""==t.instructid){e.next=10;break}return e.next=7,Object(i["updateIndustry"])(t.instructid,l);case 7:s=e.sent,e.next=14;break;case 10:return l.ACL=t.$aclObj,e.next=13,Object(i["postIndustry"])(l);case 13:s=e.sent;case 14:s.objectId&&(t.$message({type:"success",message:"".concat(t.dialogTitle,"成功")}),t.$refs.form.resetFields(),t.dialogClosed(),t.instructid="",t.Instruct()),e.next=19;break;case 17:return t.$message("有必填项未填写"),e.abrupt("return",!1);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleSizeChange:function(e){this.pagesize=e,this.Instruct()},handleCurrentChange:function(e){this.start=(e-1)*this.pagesize,this.Instruct()},dialogBtn_em:function(e,t,a){this.dialogFormVisible=!0;var n,r={};2==t?(n={name:a.name,pointer:a.di,type:a.op,enable:a.enable,duration:a.duration,order:a.order,interval:a.interval,lowerhair:a.devaddr,rotation:a.rotation,subnet:a.pn},r=Object.assign({},n),this.instructid=a.objectId):r=Object.assign({},a),this.openDialog(e,t,r)},deleteInstruct:function(e){var t=this;this.$confirm("此操作将永久删除该指令, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(i["delIndustry"])(e);case 2:n=a.sent,n&&(t.$message({type:"success",message:"删除成功!"}),t.Instruct());case 4:case"end":return a.stop()}}),a)})))).catch((function(){}))},handleSelectionChange:function(e){this.multipleTable=e},deleteAll:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=t.multipleTable.length){e.next=5;break}return t.$message({message:"请挑选要删除的指令",type:"warning"}),e.abrupt("return");case 5:return a=[],t.multipleTable.map(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.push({body:{},method:"DELETE",path:"/classes/Instruct/".concat(t.objectId)});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n={requests:a},e.next=10,t.$shuwa_batch(n);case 10:r=e.sent,r.error?t.$message({message:"删除失败".concat(r.error),type:"error"}):(t.$message({message:"删除成功",type:"success"}),t.Instruct());case 12:case"end":return e.stop()}}),e)})))()}}},o=s,c=(a("c8b8"),a("2877")),d=Object(c["a"])(o,n,r,!1,null,"4992b9dc",null);t["default"]=d.exports},c8b8:function(e,t,a){"use strict";a("143e")},cbd7:function(e,t,a){},cc85:function(e,t,a){"use strict";a("03cf")},cc9a:function(e,t,a){},d057:function(e,t,a){"use strict";a.r(t);var n,r,l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"addengine"},[a("div",{staticClass:"addcontent"},[a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"formInline",attrs:{model:e.formInline,rules:e.formlinerule,"label-width":"80px",size:"medium"}},[a("div",{staticClass:"form-block__title"},[e._v(" "+e._s(e.$translateTitle("rule.condtion"))+" "),a("div",{staticClass:"form-block__title-tips"},[e._v(" "+e._s(e.$translateTitle("rule.Processing"))+" ")])]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:e.row1}},[a("el-form-item",[a("div",{staticClass:"show-guess"},[a("p",[e._v(e._s(e.$translateTitle("rule.RuleSQLexample")))]),a("div",{staticClass:"code"},[a("code",{staticStyle:{"font-size":"12px"}},[e._v(e._s(e.sqlexample))])])])]),a("el-form-item",{attrs:{label:e.$translateTitle("rule.RuleSQL"),prop:"enginesql"}},[a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor1"}},[a("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"},model:{value:e.formInline.enginesql,callback:function(t){e.$set(e.formInline,"enginesql",t)},expression:"formInline.enginesql"}})],1)]),a("el-form-item",{attrs:{label:e.$translateTitle("rule.rule Id")}},[a("el-input",{attrs:{readonly:"编辑"==e.title,type:"text"},model:{value:e.formInline.ruleId,callback:function(t){e.$set(e.formInline,"ruleId",t)},expression:"formInline.ruleId"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.Remarks")}},[a("el-input",{attrs:{type:"text"},model:{value:e.formInline.remarks,callback:function(t){e.$set(e.formInline,"remarks",t)},expression:"formInline.remarks"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.SQLtest")}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"gray"},on:{change:e.getEditor2},model:{value:e.formInline.sqltest,callback:function(t){e.$set(e.formInline,"sqltest",t)},expression:"formInline.sqltest"}}),a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"自定义模拟数据进行 SQL 命令测试，仅用于测试功能"}},[a("i",{staticClass:"el-icon-question",staticStyle:{color:"#71737d"},attrs:{slot:"reference"},slot:"reference"})])],1)],1),a("el-col",{attrs:{span:4}}),a("el-col",{staticClass:"animated fadeInRightBig",attrs:{span:e.row2}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{rules:[{required:!0,message:"clientid 不能为空",trigger:"blur"}],label:"clientid",prop:"clientid"}},[a("el-input",{model:{value:e.formInline.clientid,callback:function(t){e.$set(e.formInline,"clientid",t)},expression:"formInline.clientid"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{rules:[{required:!0,message:"username 不能为空",trigger:"blur"}],label:"username",prop:"username"}},[a("el-input",{model:{value:e.formInline.username,callback:function(t){e.$set(e.formInline,"username",t)},expression:"formInline.username"}})],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{rules:[{required:!0,message:"topic 不能为空",trigger:"blur"}],label:"topic",prop:"topic"}},[a("el-input",{model:{value:e.formInline.topic,callback:function(t){e.$set(e.formInline,"topic",t)},expression:"formInline.topic"}})],1),1==e.formInline.sqltest?a("el-form-item",{attrs:{rules:[{required:!0,message:"qos 不能为空",trigger:"blur"}],label:"qos",prop:"qos"}},[a("el-input",{model:{value:e.formInline.qos,callback:function(t){e.$set(e.formInline,"qos",e._n(t))},expression:"formInline.qos"}})],1):e._e(),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{rules:[{required:!0,message:"请填写payload",trigger:"blur"}],label:"payload",prop:"payload"}},[a("el-input",{staticStyle:{visibility:"hidden"},attrs:{type:"text"},model:{value:e.formInline.payload,callback:function(t){e.$set(e.formInline,"payload",t)},expression:"formInline.payload"}}),a("pre",{staticClass:"ace_editor",staticStyle:{"min-height":"300px"},attrs:{id:"editor2"}},[a("el-input",{staticClass:"ace_text-input",attrs:{type:"textarea"},model:{value:e.formInline.payload,callback:function(t){e.$set(e.formInline,"payload",t)},expression:"formInline.payload"}})],1)],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:" "}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.testRule("formInline")}}},[e._v(" "+e._s(e.$translateTitle("rule.Test"))+" ")])],1),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.formInline.sqltest,expression:"formInline.sqltest == true"}],attrs:{label:e.$translateTitle("rule.TestJie")}},[a("el-input",{attrs:{rows:4,type:"textarea"},model:{value:e.formInline.result,callback:function(t){e.$set(e.formInline,"result",t)},expression:"formInline.result"}})],1)],1)],1),a("div",{staticClass:"tablebottom"},[a("div",{staticClass:"form-block__title"},[a("span",{staticStyle:{color:"rgb(255, 109, 109)"}},[e._v("*")]),e._v(" "+e._s(e.$translateTitle("rule.ResponseAction"))+" "),a("div",{staticClass:"form-block__title-tips"},[e._v(" "+e._s(e.$translateTitle("rule.Processing"))+" ")])]),a("div",{staticClass:"bottomtable",staticStyle:{"padding-left":"20px"}},[a("div",{staticClass:"tableaction"},[a("el-table",{staticStyle:{width:"100%"},attrs:{"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},data:e.actionData}},[a("el-table-column",{attrs:{label:e.$translateTitle("rule.channel")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.params.$resource?a("span",[e._v(" "+e._s("关联资源:"+t.row.params.$resource)+" ")]):a("span")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.target_topic")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.params.target_topic)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.target_qos")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.params.target_qos)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("rule.payload_tmpl")},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.params.payload_tmpl)+" ")]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return e.editAisle(t.row)}}},[e._v(" "+e._s(e.$translateTitle("button.edit"))+" ")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteOneData(t.$index)}}},[e._v(" "+e._s(e.$translateTitle("button.delete"))+" ")])]}}])})],1),a("div",[a("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"success",plain:"",icon:"el-icon-circle-plus-outline",size:"small"},on:{click:e.addresouce}},[e._v(" "+e._s(e.$translateTitle("rule.Addto"))+" ")])],1)],1)]),a("div",[a("el-dialog",{attrs:{"append-to-body":!0,title:e.$translateTitle("rule.ResponseAction"),visible:e.dialogFormVisible,"close-on-click-modal":!1,width:"40%",top:"10%"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){return e.resetForm("params")}}},[a("el-form",{ref:"params",attrs:{rules:e.paramsrules,"label-position":"left","label-width":"140px",model:e.params}},[a("el-form-item",{attrs:{prop:"channel"}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.channel")))]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重新发布消息到物联网通道",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-select",{model:{value:e.params.channel,callback:function(t){e.$set(e.params,"channel",t)},expression:"params.channel"}},e._l(e.channellist,(function(t){return a("el-option",{key:t.name,attrs:{label:t.title.zh,value:t.title.zh,disabled:"dgiot"!=t.name}},[a("span",{staticStyle:{float:"left"}},[t.title?a("i",[e._v(" "+e._s(t.title.zh)+" ")]):e._e()]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(" "+e._s(t.description.zh)+" ")])])})),1)],1),a("el-form-item",{attrs:{prop:"resources",label:e.$translateTitle("rule.resource")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.resource")))]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$translateTitle("rule.resource"),placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-select",{model:{value:e.params.resources,callback:function(t){e.$set(e.params,"resources",t)},expression:"params.resources"}},e._l(e.resources,(function(t){return a("el-option",{key:t.id,attrs:{label:t.description,value:t.id}},[a("span",{staticStyle:{float:"left"}},[t.description?a("i",[e._v(" "+e._s(t.description)+" ")]):e._e()]),a("span",{staticStyle:{float:"right",color:"#8492a6"}},[e._v(" "+e._s(t.id)+" ")])])})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.target_qos")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.target_qos")))]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重新发布消息时用的 QoS 级别, 设置为 -1 以使用原消息中的 QoS",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-select",{model:{value:e.params.target_qos,callback:function(t){e.$set(e.params,"target_qos",t)},expression:"params.target_qos"}},e._l(e.params.target_qosSelect,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.target_topic")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.target_topic")))]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"重新发布消息到哪个主题",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-input",{model:{value:e.params.target_topic,callback:function(t){e.$set(e.params,"target_topic",t)},expression:"params.target_topic"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("rule.payload_tmpl")}},[a("span",{attrs:{slot:"label"},slot:"label"},[a("span",{staticClass:"span-box"},[a("i",{staticClass:"icon-dd-schetit"}),a("span",[e._v(e._s(e.$translateTitle("rule.payload_tmpl")))]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"消息内容模板，支持变量",placement:"top-start"}},[a("i",{staticClass:"el-icon-question"})])],1)]),a("el-input",{attrs:{type:"textarea",rows:2},model:{value:e.params.payload_tmpl,callback:function(t){e.$set(e.params,"payload_tmpl",t)},expression:"params.payload_tmpl"}})],1),a("el-form-item",[e.aisleRow.name?a("el-button",{on:{click:function(t){return e.editFom("formInline")}}},[e._v(" "+e._s(e.$translateTitle("button.modify"))+" ")]):a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("params")}}},[e._v(" "+e._s(e.$translateTitle("button.create"))+" ")]),a("el-button",{on:{click:function(t){e.dialogFormVisible=!e.dialogFormVisible}}},[e._v(" "+e._s(e.$translateTitle("button.cancel"))+" ")])],1)],1)],1)],1)]),a("el-form-item",{attrs:{"label-width":"90"}},[e.ruleId.length?a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.editrules(e.ruleId,"formInline")}}},[e._v(" "+e._s(e.$translateTitle("button.modify"))+" ")]):a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addrules("formInline")}}},[e._v(" "+e._s(e.$translateTitle("button.create"))+" ")]),a("el-button",[e._v(e._s(e.$translateTitle("button.cancel")))])],1)],1)],1)],1)])},i=[],s=a("1da1"),o=(a("96cf"),a("a4d3"),a("e01a"),a("b0c0"),a("ac1f"),a("466d"),a("99af"),a("a434"),a("1b07")),c=a("9e6fe"),d={data:function(){return{ruleId:this.$route.query.id||"",uid:this.$route.query.uid||"",ruleType:this.$route.query.type||"",resources:[],aisleRow:{},params:{name:"",payload_tmpl:"${payload}",target_qos:0,target_qosSelect:[-1,0,1,2],target_topic:"thing/${productid}/${clientid}/post",$resource:"",resources:"",channel:""},dialogVisible:!1,resourceform:{objectId:"",region:"data_resource",desc:""},resourcerule:{objectId:[{required:!0,message:"请填写通道编号",trigger:"blur"}],desc:[{required:!0,message:"请填写通道描述",trigger:"blur"}]},row1:24,row2:0,dialogFormVisible:!1,title:"",formInline:{user:"",region:"",enginesql:"SELECT\n      payload.msg as msg,\n      clientid,\n      'productid' as productid\n    FROM\n      \"t/#\"\n    WHERE\n      msg = 'hello'",remarks:"",sqltest:!1,clientid:"c_swqx",username:"u_swqx",qos:1,topic:"t/a",payload:"",result:""},formlinerule:{region:[{required:!0,message:"请选择触发事件",trigger:"change"}],enginesql:[{required:!0,message:"请填写规则SQL",trigger:"blur"}]},actionData:[],form:{action:"dgiot_resource",resource:""},paramsrules:{channel:[{required:!0,message:"请选择通道",trigger:"change"}],resources:[{required:!0,message:"请选择关联资源",trigger:"change"}]},formrule:{action:[{required:!0,message:"请选择动作",trigger:"change"}]},productid:"",resourcelist:[],channellist:[],ctype:"",client:[],sqlexample:"SELECT\n      payload.msg as msg\n    FROM\n      \"t/#\"\n    WHERE\n      msg = 'hello'",actionslist:[],allChannelstart:0}},mounted:function(){this.ruleId&&this.queryRule(this.ruleId),this.title=this.$route.query.title,this.productid=this.$route.query.productid,n=ace.edit("editor1"),n.session.setMode("ace/mode/sql"),n.setTheme("ace/theme/eclipse"),n.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0});var e=ace.require("ace/ext/language_tools");e.addCompleter({getCompletions:function(e,t,a,n,r){r(null,c["default"])}}),n.setValue(this.formInline.enginesql),r=ace.edit("editor2"),r.session.setMode("ace/mode/json"),r.setTheme("ace/theme/eclipse"),r.setOptions({enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0}),r.setValue('{"msg":"hello"}')},methods:{getEditor2:function(e){1==e?(this.row1=12,this.row2=12):(this.row1=24,this.row2=0)},queryRule:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["get_rule_id"])(e);case 2:r=a.sent,l=r.data,t.actionData=l.actions,t.formInline.enginesql=l.rawsql,n.setValue(t.formInline.enginesql),t.formInline.ruleId=l.id,t.formInline.remarks=l.description,n.setValue(l.rawsql);case 10:case"end":return a.stop()}}),a)})))()},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.relationChannel(t.params)}))},editFom:function(e){this.aisleRow.name=this.params.name,this.aisleRow.params.payload_tmpl=this.params.payload_tmpl,this.aisleRow.params.target_qos=this.params.target_qos,this.aisleRow.params.target_topic=this.params.target_topic,this.aisleRow.params.$resource=this.params.$resource,this.aisleRow.params.resources=this.params.resources,this.aisleRow.params.channel=this.params.channel,this.dialogFormVisible=!this.dialogFormVisible,this.aisleRow={}},resetForm:function(e){this.$refs[e].resetFields(),this.aisleRow={}},relationChannel:function(e){this.actionData.push({name:"dgiot",params:{$resource:e.resources,target_topic:e.target_topic,target_qos:e.target_qos,payload_tmpl:e.payload_tmpl,channel:this.params.channel},fallbacks:[]}),this.dialogFormVisible=!this.dialogFormVisible},_get_actions:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["get_actions"])();case 2:a=t.sent,n=a.data,e.channellist=n;case 5:case"end":return t.stop()}}),t)})))()},_get_resources:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["get_resources"])();case 2:a=t.sent,n=a.data,e.resources=n;case 5:case"end":return t.stop()}}),t)})))()},testRule:function(e){var t=this;this.formInline.result="",this.formInline.payload=r.getValue(),this.formInline.enginesql=n.getValue(),this.$refs[e].validate((function(e){if(e){var a=/from[^"]+?"([^"]+)"/im,l={clientid:t.formInline.clientid,payload:r.getValue(),qos:t.formInline.qos,topic:t.formInline.topic,username:t.formInline.username},i={actions:t.actionData,ctx:l,description:t.formInline.remarks,for:n.getValue().match(a)[1],name:t.formInline.username,rawsql:n.getValue(),test:"true"};Object(o["addRule"])(i).then((function(e){var a=e.code;0==a?t.formInline.result=e.data.msg:t.$message.error("SQL Not Match")})).catch((function(e){t.$message.error(e)}))}}))},editrules:function(e,t){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var l,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return l={clientid:a.formInline.clientid,payload:r.getValue(),qos:a.formInline.qos,topic:a.formInline.topic,username:a.formInline.username},i={actions:a.actionData,ctx:l,description:a.formInline.remarks,for:'["t/#"]',rawsql:n.getValue()},t.next=4,Object(o["put_rule_id"])(e,i);case 4:t.sent,a.$message("修改成功"),a.$router.push({path:"/dashboard/engine"});case 7:case"end":return t.stop()}}),t)})))()},addrules:function(e){var t=this;this.formInline.payload=r.getValue(),this.formInline.enginesql=n.getValue(),this.$refs[e].validate((function(e){if(e){if(0==t.actionData.length)return void t.$message("动作不能为空");var a={clientid:t.formInline.clientid,payload:r.getValue(),qos:t.formInline.qos,topic:t.formInline.topic,username:t.formInline.username},l={actions:t.actionData,ctx:a,description:t.formInline.remarks,for:'["t/#"]',rawsql:n.getValue()};t.uid&&t.productid&&(l.id="rule:".concat(t.ruleType,"_").concat(t.productid,"_").concat(t.uid)),Object(o["addRule"])(l).then((function(e){e&&(t.$message("创建成功"),t.$router.push({path:"/dashboard/engine"}))})).catch((function(e){t.$message.error(e.error)}))}else t.$message("有必填项未填写")}))},addresouce:function(){this._get_actions(),this._get_resources(),this.aisleRow.name&&(this.params={name:this.aisleRow.name,payload_tmpl:this.aisleRow.params.payload_tmpl,target_qos:this.aisleRow.params.target_qos,target_qosSelect:[-1,0,1,2],target_topic:this.aisleRow.params.target_topic,$resource:this.aisleRow.params.$resource,resources:this.aisleRow.params.$resource,channel:this.aisleRow.params.channel}),this.dialogFormVisible=!0},addRes:function(e){var t=this;this.$refs[e].validate((function(a){if(!a)return t.$message.error("error submit!!"),!1;Object(o["postResource"])({channel:t.resourceform.objectId},t.resourceform.desc,"","data_resource").then((function(a){a&&(t.$message("创建成功"),t.$refs[e].resetFields(),t.dialogVisible=!1)}))}))},deleteOneData:function(e){this.actionData.splice(e,1)},editAisle:function(e){this.aisleRow=e,this.addresouce()}}},u=d,p=(a("ebe0"),a("2877")),m=Object(p["a"])(u,l,i,!1,null,"7d471880",null);t["default"]=m.exports},da86:function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resourcechannel"},[a("h3",[e._v("通道管理")]),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"通道管理("+e.total+")",name:"first"}},[a("div",{staticClass:"firsttable"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.channelformsearch,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("resource.name")},model:{value:e.channelformsearch.name,callback:function(t){e.$set(e.channelformsearch,"name",t)},expression:"channelformsearch.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Get_Re_Channel(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addchanneltype}},[e._v(" "+e._s(e.$translateTitle("developer.selectchannel"))+" ")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-class-name":e.getChannelEnable}},[a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):2==t.row.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")]):a("span",[e._v("任务通道")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.cType))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channelstatus")},scopedSlots:e._u([{key:"default",fn:function(t){return["ONLINE"==t.row.status?a("span",{staticStyle:{color:"green"}},[e._v(" 在线 ")]):a("span",{staticStyle:{color:"red"}},[e._v("离线")])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.channeladdr"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s("channel/"+t.row.objectId))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.desc))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{slot:"reference",type:"primary",size:"mini"},on:{click:function(a){return e.editorChannel(t.row)}},slot:"reference"},[e._v(" 编辑 ")]),0==t.row.isEnable?a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.qyChannel(t.row,"enable")}}},[e._v(" "+e._s(e.$translateTitle("developer.enable"))+" ")]):a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.qyChannel(t.row,"disable")}}},[e._v(" "+e._s(e.$translateTitle("developer.prohibit"))+" ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.updateChannel(t.row)}}},[e._v(" 详情 ")]),a("el-popover",{ref:"popover-"+t.$index,attrs:{placement:"top",width:"300"}},[a("p",[e._v("确定删除这个"+e._s(t.row.name)+"通道吗？")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t._self.$refs["popover-"+t.$index].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.deleteChannel(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1),a("el-tooltip",{staticClass:"item",attrs:{disabled:"OFFLINE"!=t.row.status,effect:"dark",content:"请先启用通道",placement:"top"}},[a("el-button",{staticStyle:{position:"absolute",width:"100px",height:"10px",opacity:"0"},attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.subProTopic(t.row)}}})],1),a("el-button",{attrs:{disabled:"OFFLINE"==t.row.status,type:"primary",size:"mini"},on:{click:function(a){return e.subProTopic(t.row)}}},[e._v(" 订阅日志 ")])]}}])})],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.length,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.channelSizeChange,"current-change":e.channelCurrentChange}})],1)],1)]),a("el-dialog",{attrs:{"append-to-body":!0,title:e.channelupdated+"通道",visible:e.channelForm,"close-on-click-modal":!1,"before-close":e.handleClose,width:"50%",top:"0"},on:{"update:visible":function(t){e.channelForm=t}}},[a("el-form",{ref:"addchannel",attrs:{model:e.addchannel,rules:e.addrules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"通道类型",prop:"region"}},[a("el-select",{attrs:{disabled:"",placeholder:"通道类型"},on:{change:e.removeauto},model:{value:e.addchannel.region,callback:function(t){e.$set(e.addchannel,"region",t)},expression:"addchannel.region"}},e._l(e.channelregion,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title.zh,value:e.cType}})})),1),a("el-row",{staticStyle:{width:"100%",height:"500px","overflow-x":"hidden","overflow-y":"scroll","line-height":"30px","text-align":"center"},attrs:{gutter:24}},e._l(e.channelregion,(function(t,n){return a("el-col",{key:n,staticStyle:{margin:"20px 0",cursor:"pointer"},attrs:{span:8}},[a("el-card",{staticClass:"box-card",style:{color:e.addchannel.region==t.cType?"#00bad0":"#c0c4cc"},attrs:{shadow:e.addchannel.region==t.cType?"always":"hover",size:"mini"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.title.zh))]),a("el-button",{staticStyle:{float:"right"},attrs:{disabled:""!=e.resourceid,type:e.addchannel.region==t.cType?"success":"primary",size:"mini"},on:{click:function(a){return e.setCard(t.cType)}}},[e._v(" "+e._s(e.addchannel.region==t.cType?"已选择":"选择")+" ")])],1),a("div",{staticClass:"text item"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("img",{staticClass:"image",staticStyle:{width:"50px",height:"50px"},attrs:{src:"https://imgs.iotku.com/2020/2/21/23efecea9bfdbbf8a132089e251fc6e7.png"}})]),a("el-col",{attrs:{span:12}},[a("el-tag",[e._v(e._s(t.cType))])],1)],1)],1)])],1)})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("developer.channelname"),autocomplete:"off"},model:{value:e.addchannel.name,callback:function(t){e.$set(e.addchannel,"name",t)},expression:"addchannel.name"}})],1),a("el-form-item",{attrs:{rules:[{required:!0,message:"请选择所属应用",trigger:"blur"}],label:"所属应用"}},[a("el-input",{attrs:{placeholder:"请选择所属应用"},model:{value:e.addchannel.applicationtText,callback:function(t){e.$set(e.addchannel,"applicationtText",t)},expression:"addchannel.applicationtText"}},[a("template",{slot:"append"},[a("i",{class:[e.showTree?"el-icon-arrow-up":"el-icon-arrow-down"],staticStyle:{cursor:"pointer"},on:{click:function(t){e.showTree=!e.showTree}}})])],2),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.title.zh,required:t.required,prop:t.showname}},["string"==t.type?a("el-input",{model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}}):"integer"==t.type?a("el-input",{model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}}):"boolean"==t.type?a("el-select",{staticClass:"notauto",attrs:{readonly:""},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},[a("el-option",{attrs:{value:!0,label:"是"}}),a("el-option",{attrs:{value:!1,label:"否"}})],1):e._e()],1)],1)})),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{rows:3,placeholder:e.$translateTitle("developer.describe"),autocomplete:"off",type:"textarea"},on:{change:e.inputChange},model:{value:e.addchannel.desc,callback:function(t){e.$set(e.addchannel,"desc",t)},expression:"addchannel.desc"}})],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addchannelForm("addchannel")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible,title:"通道详情",width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[e._v("ID:")]),a("el-col",{attrs:{span:12}},[e._v(e._s(e.resourceid))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Resource Type:")]),a("el-col",{attrs:{span:12}},[e._v(e._s(e.resoucetype))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Description:")]),a("el-col",{attrs:{span:12}},[e._v(e._s(e.description))])],1),e._l(e.detailchannel,(function(t,n){return a("el-row",{key:t},[a("el-col",{attrs:{span:12}},[e._v(e._s(n))]),a("el-col",{attrs:{span:12}},[e._v(e._s(t))])],1)}))],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" 确 定 ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,title:e.channelname+"日志",visible:e.subdialog,"before-close":e.handleCloseSubdialog,width:"85%"},on:{"update:visible":function(t){e.subdialog=t}}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("pre",{staticClass:"ace_editor",staticStyle:{width:"100%","min-height":"300px"},attrs:{id:"subdialog"}},[e._v("                    "),a("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}}),e._v("        ")])]),a("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[a("el-switch",{staticStyle:{display:"inline-block","margin-right":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"自动刷新"},on:{change:e.stopsub},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}})],1)])],1)],1)},l=[],i=a("1da1"),s=a("5530"),o=(a("96cf"),a("b0c0"),a("d81d"),a("a4d3"),a("e01a"),a("4e82"),a("4d63"),a("ac1f"),a("25f0"),a("89e8")),c=a("5880"),d=a("bb22"),u=a("5da9"),p=a("1b07"),m=a("926a"),h=a("c620"),f={inject:["reload"],data:function(){return{dialogVisible:!1,isopen:"suo",pwdType:"password",tableData:[],channelForm:!1,channelupdated:"新增",activeName:"first",channelId:"",channelformsearch:{name:""},channelregion:[],addchannel:{region:"",desc:"",applicationtText:""},applicationList:[],addrules:{roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]},length:10,start:0,total:0,selectregion:{},resourceid:"",resoucetype:"",description:"",detailchannel:"",subdialog:!1,value4:"",subdialogid:"",subdialogtimer:null,channelname:"",arrlist:[],channelrow:[],showTree:!1,allApps:[],defaultProps:{children:"children",label:"label"}}},computed:Object(s["a"])({},Object(c["mapGetters"])({roleTree:"user/roleTree"})),mounted:function(){this.Get_Re_Channel(0),this.dialogType(),this.getApplication()},methods:{setCard:function(e){this.removeauto(e)},inputChange:function(e){},validUrl:function(e,t,a){var n=/^[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/;n.test(t)?a():a(new Error("需要输入正确的url"))},validPort:function(e,t,a){var n=/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;n.test(t)?a():a(new Error("需要输入正确的端口号"))},Get_Re_Channel:function(e){var t=this;0==e&&(this.start=0);var a={count:"objectId",order:"-createdAt",limit:this.length,skip:this.start,where:{}};""!=this.channelformsearch.name&&(a.where.name=this.channelformsearch.name),this.$query_object("Channel",a).then((function(e){e&&(t.total=e.count,t.tableData=e.results)})).catch((function(e){"209"==e.code?(t.$message({type:"warning",message:"登陆权限过期，请重新登录"}),t.$router.push({path:"/login"})):119==e.code&&t.$message({type:"error",message:"没有操作权限"})}))},getApplication:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={limit:100},t.next=3,Object(u["queryRole"])(a);case 3:n=t.sent,r=n.results,r.map((function(t){var a={};a.id=t.id,a.name=t.desc,e.applicationList.push(a)}));case 6:case"end":return t.stop()}}),t)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.addchannel.applicationtText=e.name},dialogType:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(p["resourceTypes"])();case 3:a=t.sent,e.channelregion=a;case 5:case"end":return t.stop()}}),t)})))()},qyChannel:function(e,t){var a=this;Object(d["subupadte"])(e.objectId,t).then((function(e){e&&a.$message({type:"success",message:"".concat("enable"==t?"启用成功":"禁用成功")}),a.Get_Re_Channel(0)})).catch((function(e){a.$message(e.error)}))},updateChannel:function(e){this.dialogVisible=!0,this.resourceid=e.objectId,this.detailchannel=e.config,this.resoucetype=e.cType,this.description=e.desc},addchannelForm:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var a={};for(var n in t.addchannel)a[n]=t.addchannel[n];delete a.region,delete a.desc,delete a.type,delete a.isEnable,delete a.name;var r="role:"+t.addchannel.applicationtText,l={};l[r]={read:!0,write:!0};var i={ACL:l,config:a,name:t.addchannel.name,cType:t.addchannel.region,desc:t.addchannel.desc};t.addchannelaxios(i)}}),(function(e){Object(m["returnLogin"])(e)}))},addchannelaxios:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["postChannel"])(e).then((function(e){e&&(t.$message({type:"success",message:"编辑"==t.channelupdated?"编辑成功":"创建成功"}),t.$refs["addchannel"].resetFields(),t.addchannel={},t.channelForm=!1,t.resourceid="",t.Get_Re_Channel(0))}));case 2:case"end":return a.stop()}}),a)})))()},deleteChannel:function(e){var t=this;Object(o["delChannel"])(e.row.objectId).then((function(a){t.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(e.$index)].doClose(),t.Get_Re_Channel(0)})).catch((function(e){}))},addchanneltype:function(){this.channelForm=!0,this.channelupdated="新增"},handleClose:function(){this.addchannel={},this.channelForm=!1,this.$refs["addchannel"].resetFields(),this.resourceid=""},getChannelEnable:function(e,t){return 1==e.row.isEnable?"green_active":"red_active"},channelSizeChange:function(e){this.length=e,this.Get_Re_Channel()},channelCurrentChange:function(e){this.start=(e-1)*this.length,this.Get_Re_Channel()},arrSort:function(e,t){var a=e.order,n=t.order;return a<n?-1:a>n?1:0},orderObject:function(e){var t=[];for(var a in e)e[a].showname=a,t.push(e[a]);return t.sort(this.arrSort)},removeauto:function(e){var t=this,a={},n={name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]};if(""==this.resourceid?this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(e){e.default?a[e.showname]=e.default:a[e.showname]="",e.required&&("string"==e.type||"integer"==e.type?n[e.showname]=[{required:!0,trigger:"blur"}]:n[e.showname]=[{required:!0,trigger:"change"}])})),a.region=e,a.desc="",a.name="",a.type=t.selectregion.type,a.isEnable=!1)})):this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(r){for(var l in t.channelrow.config)r.showname==l&&(a[r.showname]=t.channelrow.config[l]),r.required&&("string"==r.type||"integer"==r.type?n[r.showname]=[{required:!0,trigger:"blur"}]:n[r.showname]=[{required:!0,trigger:"change"}]),a.region=e,a.desc=t.channelrow.desc,a.name=t.channelrow.name,a.type=t.selectregion.type,a.isEnable=t.channelrow.isEnable})))})),this.channelrow.length>0)for(var r in this.channelrow.ACL.permissionsById)a.applicationtText=r?r.substr(5):"";this.addchannel=a,this.addchannel.region=e,this.addrules=n},editorChannel:function(e){this.channelrow=e,this.resourceid=e.objectId,this.channelForm=!0,this.channelupdated="编辑",this.removeauto(e.cType)},nowtime:function(){var e=Date.parse(new Date),t=new Date(e),a=(t.getFullYear(),t.getMonth()+1<=10?t.getMonth():t.getMonth(),t.getDate()+1<=10?t.getDate():t.getDate(),(t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":"),n=(t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":",r=t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds();return a+n+r+" "},subProTopic:function(e){this.subdialog=!0,this.subdialogid=e.objectId,this.channelname=e.objectId,setTimeout((function(){n=ace.edit("subdialog"),n.session.setMode("ace/mode/text"),n.setTheme("ace/theme/gob"),n.setReadOnly(!0),n.setOptions({enableBasicAutocompletion:!1,enableSnippets:!0,enableLiveAutocompletion:!0})}));var t={topic:"log/channel/"+e.objectId,qos:2},a=new RegExp("log/channel/"+e.objectId),r="",l=this;h["Websocket"].add_hook(a,(function(e){n.session.getLength()>=1e3?r="":r+=l.nowtime()+e+"\n",n.setValue(r),n.gotoLine(n.session.getLength())}));var i=JSON.stringify({action:"start_logger"});h["Websocket"].subscribe(t,(function(t){if(t.result){var a={topic:"channel/"+e.objectId,text:i,retained:!0,qos:2};h["Websocket"].sendMessage(a),l.subdialogtimer=window.setInterval((function(){h["Websocket"].sendMessage(a)}),6e5)}}))},stopsub:function(e){var t;t=0==e?JSON.stringify({action:"stop_logger"}):JSON.stringify({action:"start_logger"});var a={topic:"channel/"+this.subdialogid,text:t,retained:!0,qos:2};h["Websocket"].sendMessage(a)},handleCloseSubdialog:function(){var e=JSON.stringify({action:"stop_logger"}),t={topic:"channel/"+this.subdialogid,text:e,retained:!0,qos:2};h["Websocket"].sendMessage(t),this.subdialog=!1,window.clearInterval(this.subdialogtimer),this.subdialogtimer=null}}},g=f,b=(a("49fb"),a("2877")),v=Object(b["a"])(g,r,l,!1,null,"60ec2014",null);t["default"]=v.exports},dc8a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"application"},[a("div",{staticClass:"addApplication"}),a("div",{staticClass:"appcontent",staticStyle:{position:"relative",display:"flex","flex-direction":"column","align-items":"center"}},[e._l(e.appdata,(function(t,n){return a("el-card",{key:n,staticClass:"box-card",staticStyle:{width:"80%","margin-bottom":"10px",border:"1px solid #cccccc"}},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("i",{staticClass:"iconfont icon-yingyong",staticStyle:{color:"#666666"}}),a("p",[e._v(e._s(t.name))])])]),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content bg-purple"},[a("dl",[a("dt",[e._v(" "+e._s(e.$translateTitle("product.appid"))+" "),a("el-tooltip",{attrs:{content:e.$translateTitle("product.TheonlyapplicationIDintheSDKcallingprocess"),placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),a("dd",[e._v(e._s(t.objectId))]),a("dt",[e._v(" "+e._s(e.$translateTitle("product.appsecret"))+" "),a("el-tooltip",{attrs:{content:e.$translateTitle("product.aaab"),placement:"bottom"}},[a("i",{staticClass:"el-icon-question"})])],1),t.isshow?a("dd",[e._v(e._s(t.tag.appconfig.secret))]):e._e(),t.isshow?e._e():a("dd",[t.tag.appconfig.secret?a("i",[e._v(" "+e._s(t.tag.appconfig.secret.substr(0,4)+"********************"+t.tag.appconfig.secret.substr(24))+" "),a("el-button",{staticStyle:{position:"absolute",top:"30px","margin-left":"10px"},attrs:{size:"samll",round:""},on:{click:function(a){return e.xianshi(t.objectId)}}},[e._v(" "+e._s(e.$translateTitle("product.fullkey"))+" ")])],1):e._e()]),a("dt",[e._v(" "+e._s(e.$translateTitle("task.Applicationname"))+" "),a("i",{staticClass:"el-icon-s-promotion"})]),t.name?a("dd",[e._v(e._s(t.name))]):a("dd",[e._v("-")])])])]),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content bg-purple"},[a("p",{staticClass:"editor"},[a("strong",[e._v(" "+e._s(e.$translateTitle("task.Operation")+":")+" ")])]),a("p",{staticClass:"editor"},[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.updateapp(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.Modifyapplication"))+" ")])],1),a("p",{staticClass:"editor"},[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.nodeDeployment(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.Nodedeployment"))+" ")])],1),a("p",{staticClass:"editor"},[a("el-link",{attrs:{type:"primary"},on:{click:function(a){return e.applicationDeployment(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.Applicationdeployment"))+" ")])],1)])])],1)],1)})),a("el-pagination",{attrs:{"page-sizes":[1,5,10],"page-size":e.pagesize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],2),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible,"close-on-click-modal":!1,title:e.$translateTitle("developer.addapp"),width:"55%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"block",attrs:{"element-loading-text":e.$translateTitle("developer.Waitingtoreturn"),"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("el-form",{ref:"form",attrs:{rules:e.Rule,model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.applicationname"),prop:"desc"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("application.applicationname")},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.tokeneffectivetime")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"number",placheholder:e.$translateTitle("product.enterapptime")},model:{value:e.form.time,callback:function(t){e.$set(e.form,"time",t)},expression:"form.time"}}),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(" "+e._s(e.$translateTitle("application.seconds"))+" ")])],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordpreviewserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordpreviewserver")},model:{value:e.form.wordpreview,callback:function(t){e.$set(e.form,"wordpreview",t)},expression:"form.wordpreview"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordproductionserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordproductionserver")},model:{value:e.form.wordproduct,callback:function(t){e.$set(e.form,"wordproduct",t)},expression:"form.wordproduct"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.fileresources"),prop:"file"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.url},model:{value:e.form.file,callback:function(t){e.$set(e.form,"file",t)},expression:"form.file"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.Configurationresources"),prop:"topo"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form.topo,callback:function(t){e.$set(e.form,"topo",t)},expression:"form.topo"}})],1),a("el-form-item",{attrs:{label:"Graphql API",prop:"graphql"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form.graphql,callback:function(t){e.$set(e.form,"graphql",t)},expression:"form.graphql"}})],1),a("el-form-item",{attrs:{label:"Restful API",prop:"rest"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form.rest,callback:function(t){e.$set(e.form,"rest",t)},expression:"form.rest"}})],1),a("el-form-item",{attrs:{label:"home"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("developer.path")},model:{value:e.form.home,callback:function(t){e.$set(e.form,"home",t)},expression:"form.home"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Define("form")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.update,"close-on-click-modal":!1,title:e.$translateTitle("product.modify")+e.$translateTitle("product.Applicationinformation"),width:"55%"},on:{"update:visible":function(t){e.update=t}}},[a("div",{staticClass:"block"},[a("el-form",{ref:"form1",attrs:{rules:e.Rule,model:e.form1,"label-width":"170px"}},[a("el-form-item",{attrs:{label:e.$translateTitle("application.Accesskey")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{readonly:""},model:{value:e.form1.secret,callback:function(t){e.$set(e.form1,"secret",t)},expression:"form1.secret"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-refresh-right"},on:{click:e.handleClickRefresh},slot:"append"})],1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.tokeneffectivetime")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{type:"number",placheholder:e.$translateTitle("product.enterapptime")},model:{value:e.form1.time,callback:function(t){e.$set(e.form1,"time",t)},expression:"form1.time"}}),a("span",{staticStyle:{"margin-left":"5px"}},[e._v(" "+e._s(e.$translateTitle("task.Seconds"))+" ")])],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordpreviewserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordpreviewserver")},model:{value:e.form1.wordpreview,callback:function(t){e.$set(e.form1,"wordpreview",t)},expression:"form1.wordpreview"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("product.Wordproductionserver")}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("product.Wordproductionserver")},model:{value:e.form1.wordproduct,callback:function(t){e.$set(e.form1,"wordproduct",t)},expression:"form1.wordproduct"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.fileresources"),prop:"file"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.file,callback:function(t){e.$set(e.form1,"file",t)},expression:"form1.file"}})],1),a("el-form-item",{attrs:{label:e.$translateTitle("application.Configurationresources"),prop:"topo"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.topo,callback:function(t){e.$set(e.form1,"topo",t)},expression:"form1.topo"}})],1),a("el-form-item",{attrs:{label:"Graphql API",prop:"graphql"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.graphql,callback:function(t){e.$set(e.form1,"graphql",t)},expression:"form1.graphql"}})],1),a("el-form-item",{attrs:{label:"Restful API",prop:"rest"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:"$translateTitle('product.enter1') + url"},model:{value:e.form1.rest,callback:function(t){e.$set(e.form1,"rest",t)},expression:"form1.rest"}})],1),a("el-form-item",{attrs:{label:"home"}},[a("el-input",{staticStyle:{width:"80%"},attrs:{placheholder:e.$translateTitle("product.enter1")+e.$translateTitle("developer.path")},model:{value:e.form1.home,callback:function(t){e.$set(e.form1,"home",t)},expression:"form1.home"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.update=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updatedDefine("form1")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)])],1)},r=[],l=a("1da1"),i=(a("96cf"),a("a9e3"),a("d81d"),a("b0c0"),a("5da9")),s=a("f43e").Base64,o={data:function(){var e=function(e,t,a){var n=/^(((ht|f)tps?):\/\/)?[\w-]+(\.[\w-]+)+([\w.,@?^=%&:/~+#-]*[\w@?^=%&/~+#-])?$/;""===t||null===t?a(new Error("请输入url地址")):n.test(t)?a():a(new Error("请输入正确的url地址"))};return{total:0,pagesize:10,start:0,update:!1,form1:{name:"",product:"",time:"",file:"",graphql:"",rest:"",topo:"",secret:"",desc:"",home:"",wordpreview:"http://pump.iotn2n.com:8012",wordproduct:"http://pump.iotn2n.com"},dialogVisible:!1,form:{name:"",product:"",time:"18000",file:"http://file.iotn2n.com/shapes/upload",graphql:"http://cad.iotn2n.com:5080/graphql",rest:"http://cad.iotn2n.com:5080/iotapi",topo:"http://shapes.iotn2n.com/",secret:"",home:"D:/shuwa/shuwa_data_center",wordpreview:"http://pump.iotn2n.com:8012",wordproduct:"http://pump.iotn2n.com/"},Rule:{desc:[{required:!0,message:"请输入应用名称",trigger:"blur"},{validator:function(e,t,a){0===t.length?a(new Error("应用名称不能为空")):a()}}],file:[{trigger:"blur",validator:e}],topo:[{trigger:"blur",validator:e}],graphql:[{trigger:"blur",validator:e}],rest:[{trigger:"blur",validator:e}]},appdata:[],objectid:"",selectapp:[],arr:[],loading:!1}},created:function(){},mounted:function(){this.getAppdetail(this.pagesize,this.start),this.$route.query&&this.$route.query.projectName&&(this.dialogVisible=!0,this.form.desc=this.$route.query.projectName)},methods:{Define:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.submit()}))},submit:function(){this.loading=!0;var e=Math.ceil(25*Math.random());s.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date)),this.form.file,this.form.graphql,this.form.rest,this.form.topo,this.form.home},getAppdetail:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r={skip:t,limit:e,keys:"tag,name,desc,count(*)",order:"updatedAt"},Object(i["queryRole"])(r).then((function(e){a.appdata=e.results,a.appdata.map((function(e){e.tag.appconfig.secret&&(e.isshow=!1)})),a.total=e.count})).catch((function(e){}));case 2:case"end":return n.stop()}}),n)})))()},handleClickRefresh:function(){this.randomSecret()},randomSecret:function(){var e=Math.ceil(25*Math.random());this.form1.secret=s.encode(String.fromCharCode(65+e)+Math.ceil(1e7*Math.random())+Number(new Date))},handleSizeChange:function(e){this.pagesize=e,this.getAppdetail(this.pagesize,this.start)},handleCurrentChange:function(e){this.start=Number(e-1)*Number(this.pagesize),this.getAppdetail(this.pagesize,this.start)},updateapp:function(e){this.update=!0,this.form1.objectId=e.objectId,this.form1.time=e.tag.appconfig.expires,this.form1.file=e.tag.appconfig.file,this.form1.rest=e.tag.appconfig.rest,this.form1.topo=e.tag.appconfig.topo,this.form1.graphql=e.tag.appconfig.graphql,this.form1.home=e.tag.appconfig.home,this.form1.secret=e.tag.appconfig.secret,this.form1.desc=e.tag.appconfig.desc},updatedDefine:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;t.updateObj(t.form1.objectId)}))},updateObj:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={expires:t.form1.time,file:t.form1.file,graphql:t.form1.graphql,rest:t.form1.rest,topo:t.form1.topo,home:t.form1.home,secret:t.form1.secret,wordpreview:t.form1.home,wordproduct:t.form1.secret},r={appconfig:{}},r.appconfig=n,a.next=5,Object(i["putRole"])(e,r).then((function(e){t.$message({type:"success",message:"应用修改成功"}),t.getAppdetail(10,0),t.update=!1})).catch((function(e){t.$message({type:"error",message:"应用修改失败"+e.error})}));case 5:case"end":return a.stop()}}),a)})))()},nodeDeployment:function(e){this.$router.push({path:"/roles/server_control",query:{appid:e.objectId,appsecret:e.tag.appconfig.secret}})},applicationDeployment:function(e){this.$router.push({path:"/applicationManagement/addApp",query:{actionType:"add",title:"新增应用",appObjectId:e.objectId,desc:e.desc,name:e.name}})},xianshi:function(e){for(var t,a=0;a<this.appdata.length;a++)this.appdata[a].objectId==e&&(t=this.appdata[a],this.appdata[a].isshow=!0,this.$set(this.appdata,a,t))}}},c=o,d=(a("1be9"),a("05cc"),a("2877")),u=Object(d["a"])(c,n,r,!1,null,"662e0a6e",null);t["default"]=u.exports},ddf0:function(e,t,a){"use strict";a("88b5")},e81a:function(e,t,a){},ebe0:function(e,t,a){"use strict";a("6cde")},ef76:function(e,t,a){"use strict";a("e81a")},f7ea:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"application"}},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:e.$translateTitle("developer.Applicationmanagement"),name:"app"}},[a("div",{staticClass:"form"},[a("div",{staticClass:"search"},[a("el-input",{attrs:{placeholder:e.$translateTitle("application.applicationname"),size:"small"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getAppMange(0)}}},[e._v(" "+e._s(e.$translateTitle("application.search"))+" ")])],1)]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:e.$translateTitle("application.applicationidentification"),prop:"productIdentifier"}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.applicationname"),prop:"title"}}),a("el-table-column",{attrs:{prop:"userUnit",label:e.$translateTitle("developer.Applicationunit")}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.scaleofservice"),prop:"scale",sortable:""}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.industrytype"),prop:"category"}}),a("el-table-column",{attrs:{label:e.$translateTitle("application.createtime"),prop:"creation_time"}}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),prop:"operation",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{ref:"popover-"+t.$index,attrs:{placement:"top",width:"300"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.qdsczg"))+e._s(t.row.name)+e._s(e.$translateTitle("equipment.yym"))+" ")]),a("div",{staticStyle:{margin:"0","text-align":"right"}},[a("el-button",{attrs:{size:"mini"},on:{click:function(e){t._self.$refs["popover-"+t.$index].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.makeSure(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-link",{attrs:{slot:"reference",underline:!1,icon:"el-icon-delete",type:"danger"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1),a("el-button",{attrs:{type:"text",size:"small",icon:"el-icon-edit"},on:{click:function(a){return e.handleClickUpdate(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.edit"))+" ")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.Gotoproduct(t)}}},[a("i",{staticClass:"el-icon-s-management"}),e._v(" "+e._s(e.$translateTitle("leftbar.management"))+" ")]),a("el-link",{attrs:{underline:!1,type:"primary"},on:{click:function(a){return e.applicationDeployment(t.row)}}},[e._v(" "+e._s(e.$translateTitle("developer.deploy"))+" ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":e.page.pageSizes,"page-size":e.page.pageSize,total:e.page.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},r=[],l=(a("b0c0"),a("a4d3"),a("e01a"),a("99af"),a("1285")),i=a("7212"),s=a("ed08"),o=a("1c4e"),c={data:function(){return{label:"我的应用",activeName:"app",dialogVisible:!1,name:"",page:{currentPage:0,pageSizes:[10,20,30],pageSize:10,total:0},description:"暂无数据",tableData:[],isShow:!1,arr:[]}},created:function(){this.getAppMange()},methods:{handleClickVisit:function(e){var t=e.$index,a=this.tableData[t].productIdentifier,n=window.location.origin+"/iot/"+a+"#/login";window.open(n,"__blank")},getAppMange:function(e){var t=this;0==e&&(this.page.currentPage=0),this.tableData=[];var a={};this.name&&(a.title=this.name),Object(o["getProject"])({limit:this.page.pageSize,skip:this.page.currentPage,count:"objectId",where:a}).then((function(e){var a=e.results;t.label="我的应用(".concat(e.count,")"),t.description="获取".concat(a.length,"条数据"),t.page.total=e.count;for(var n=0;n<a.length;n++){var r={};r.name=a[n].title,r.objectId=a[n].objectId,r.productIdentifier=a[n].productIdentifier,r.scale=Object(o["handleZero"])(a[n].scale),r.creation_time=Object(s["utc2beijing"])(a[n].createdAt),r.end_time=Object(s["utc2beijing"])(a[n].updatedAt),r.category=a[n].category,r.secret=a[n].secret,r.logo=a[n].logo,r.title=a[n].title,r.userUnit=a[n].userUnit,r.dashboard=a[n].dashboard,r.background=a[n].background,r.acl=a[n].ACL,r.desc=a[n].desc,r.copyright=a[n].copyright,t.tableData.push(r)}}))},handleSizeChange:function(e){this.page.pageSize=e,this.getAppMange()},handleCurrentChange:function(e){this.page.currentPage=(e-1)*this.page.pageSize,this.getAppMange()},handleClickLook:function(e){e.$index;var t='\n          <table\n              class="mailtable"\n              style="width:100%;"\n              border="0"\n              cellspacing="0"\n              cellpadding="0"\n            >\n              <tr>\n                  <td style="text-align:left;\n                  color: #74777a;\n                  font-weight: 400;\n                  background: #fafafc;\n                  width:200px;\n                  font-weight:bold;">App Id:</td>\n                  <td>'.concat(e.row.objectId,'</td>\n              </tr>\n              <tr ">\n                   <td style="color: #74777a;\n                  font-weight: 400;\n                  background: #fafafc;\n                  width:200px;\n                  padding-top:20px;\n                  font-weight:bold;">App Secret:\n                  </td>\n                  <td style="padding-top:20px;">').concat(e.row.secret,"</td>\n              </tr>\n              </table>\n          ");this.$alert(t,"应用详情",{dangerouslyUseHTMLString:!0})},handleClickUpdate:function(e){var t=e.row;this.$router.push({path:"/applicationManagement/addApp",query:{actionType:"update",title:"修改应用",name:t.name,scale:t.scale,creation_time:t.creation_time,end_time:t.end_time,category:t.category,productIdentifier:t.productIdentifier,secret:t.secret,objectId:t.objectId,logo:t.logo,userUnit:t.userUnit,dashboard:t.dashboard,background:t.background,desc:t.desc,copyright:t.copyright}})},makeSure:function(e){var t=this,a={count:"objectId",skip:0,limit:1,where:{product:e.row.objectId}};Object(l["queryDevice"])(a).then((function(a){a.count>0?t.$message("请先删除该产品下设备"):Object(i["getProduct"])(e.row.objectId).then((function(a){Object(i["delProduct"])(e.row.objectId).then((function(a){a&&(t.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(e.$index)].doClose(),t.getAppMange())})).catch((function(e){}))})).catch((function(e){}))})).catch((function(e){}))},Gotoproduct:function(e){var t=[];for(var a in e.row.acl)t.push(a.substring(5));this.$store.dispatch("setProjectRole",t),this.$router.push({path:"/roles/product",query:{project:e.row.objectId}})},serverlictool:function(e){this.$router.push({path:"/roles/server_control",query:{appid:e.objectId,appsecret:e.secret}})},applicationDeployment:function(e){var t=this;e.name?Object(o["setUpLictool"])(e.name).then((function(e){e&&t.$message("正在部署中")})).catch((function(e){t.$message(e)})):this.$message("没有应用名")}}},d=c,u=(a("ef76"),a("2877")),p=Object(u["a"])(d,n,r,!1,null,"e71deac4",null);t["default"]=p.exports},fab5:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"checkengine"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{"fonty-size":"16px"}},[e._v("基本信息")])]),a("div",{staticClass:"box-form"},[a("el-form",{attrs:{model:e.engineform,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"触发事件:"}},[a("span",[e._v(e._s(e.engineform.region))])]),a("el-form-item",{attrs:{label:"规则SQL:"}},[a("span",[e._v(e._s(e.engineform.sql))])]),a("el-form-item",{attrs:{label:"备注:"}},[a("span",[e._v(e._s(e.engineform.remarks))])])],1)],1)]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("度量指标")])]),a("div",{staticClass:"box-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.engineData,"default-sort":{prop:"date",order:"descending"}}},[a("el-table-column",{attrs:{prop:"node",label:"节点"}}),a("el-table-column",{attrs:{prop:"matched",label:"已命中",sortable:"",width:"180"}}),a("el-table-column",{attrs:{prop:"speed",label:"命中速度",sortable:"",width:"180"}}),a("el-table-column",{attrs:{prop:"speed_max",label:"最大命中速度"}}),a("el-table-column",{attrs:{prop:"speed_last5m",label:"5分钟平均速度"}})],1)],1)]),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("响应动作")])]),a("div",{staticClass:"box-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.rulesdata}},[a("el-table-column",{attrs:{prop:"name",label:"类型",width:"180"}}),a("el-table-column",{attrs:{label:"参数"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.params))])]}}])}),a("el-table-column",{attrs:{label:"度量指标",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("ul",[e._l(t.row.metrics,(function(t,n){return a("li",{key:n},[a("span",{staticStyle:{display:"inline-block",width:"120px"}},[e._v(" "+e._s(t.node)+" ")]),a("span",{staticClass:"type"},[e._v(e._s("成功:"+t.success))]),a("span",{staticClass:"type"},[e._v(e._s("失败:"+t.failed))])])})),a("li",[a("span",{staticStyle:{display:"inline-block",width:"120px","margin-top":"20px"}},[e._v(" 合计 ")]),a("span",{staticClass:"type"},[e._v(" "+e._s("成功:"+e.allsuccss(t.row.metrics))+" ")]),a("span",{staticClass:"type"},[e._v(" "+e._s("失败:"+e.allfailed(t.row.metrics))+" ")])])],2)]}}])})],1)],1)])],1)},r=[],l=(a("a15b"),a("a4d3"),a("e01a"),a("d81d"),a("1b07")),i={data:function(){return{engineform:{region:"",remarks:"",sql:""},engineData:[],ruleid:"",rulesdata:[]}},mounted:function(){this.detailForRule()},methods:{detailForRule:function(){var e=this;this.rulesdata=[],this.ruleid=this.$route.query.id,Object(l["getRuleDetail"])(this.ruleid).then((function(t){t.data&&(e.engineform.region=t.data.for.join(","),e.engineform.remarks=t.data.description,e.engineform.sql=t.data.rawsql,e.engineData=t.data.metrics,e.rulesdata=t.data.actions)})).catch((function(t){e.$message(t.error)}))},allsuccss:function(e){var t=0;return e.map((function(e){t+=e.success})),t},allfailed:function(e){var t=0;return e.map((function(e){t+=e.failed})),t}}},s=i,o=(a("ddf0"),a("2877")),c=Object(o["a"])(s,n,r,!1,null,"7a2f7d09",null);t["default"]=c.exports},fcbb:function(e,t,a){"use strict";a.r(t);var n,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"resourcechannel"},[a("VabMqtt",{ref:"mqtt",attrs:{topic:e.channeltopic},on:{mqttMsg:e.mqttMsg}}),a("vab-input",{ref:"uploadFinish",on:{fileInfo:e.fileInfo}}),a("div",{staticClass:"firsttable"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.channelformsearch,size:"small"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:e.$translateTitle("resource.name")},model:{value:e.channelformsearch.name,callback:function(t){e.$set(e.channelformsearch,"name",t)},expression:"channelformsearch.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.Get_Re_Channel(0)}}},[e._v(" "+e._s(e.$translateTitle("developer.search"))+" ")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addchanneltype}},[e._v(" "+e._s(e.$translateTitle("developer.selectchannel"))+" ")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{"header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"},data:e.tableData,"row-class-name":e.getChannelEnable}},[a("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":"",width:"150",label:e.$translateTitle("developer.channelnumber")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.objectId))])]}}])}),a("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":"",width:"160",label:e.$translateTitle("developer.channelname")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":"",width:"180",label:e.$translateTitle("developer.channeltype")},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.collectionchannel"))+" ")]):2==t.row.type?a("span",[e._v(" "+e._s(e.$translateTitle("developer.resourcechannel"))+" ")]):a("span",[e._v(" "+e._s(e.$translateTitle("developer.missionchannel"))+" ")])]}}])}),a("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":"",width:"140",label:e.$translateTitle("developer.servicetype")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.cType))])]}}])}),a("el-table-column",{attrs:{sortable:"","show-overflow-tooltip":"",width:"100",label:e.$translateTitle("developer.channelstatus")},scopedSlots:e._u([{key:"default",fn:function(t){return["ONLINE"==t.row.status?a("span",{staticStyle:{color:"green"}},[e._v(" "+e._s(e.$translateTitle("product.online"))+" ")]):a("span",{staticStyle:{color:"red"}},[e._v(" "+e._s(e.$translateTitle("product.offline"))+" ")])]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",sortable:"",label:e.$translateTitle("developer.channeladdr"),width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s("channel/"+t.row.objectId))])]}}])}),a("el-table-column",{attrs:{width:"120","show-overflow-tooltip":"",label:e.$translateTitle("developer.enable")+"/"+e.$translateTitle("developer.disable")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{content:t.row.isEnable?e.$translateTitle("developer.enable"):e.$translateTitle("developer.disable"),placement:"top"}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.switchEnable(t.row.objectId,t.row.isEnable)}},model:{value:t.row.isEnable,callback:function(a){e.$set(t.row,"isEnable",a)},expression:"scope.row.isEnable"}})],1)]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",label:e.$translateTitle("developer.describe")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.desc))])]}}])}),a("el-table-column",{attrs:{label:e.$translateTitle("developer.operation"),fixed:"right",width:"340"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{slot:"reference",type:"primary",size:"mini"},on:{click:function(a){return e.editorChannel(t.row)}},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("task.Edit"))+" ")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.updateChannel(t.row)}}},[e._v(" "+e._s(e.$translateTitle("product.details"))+" ")]),a("el-popover",{ref:"popover-"+t.$index,staticStyle:{"margin-left":"10px"},attrs:{placement:"top",width:"300"}},[a("p",[e._v(" "+e._s(e.$translateTitle("product.qdsczg"))+e._s(t.row.name)+e._s(e.$translateTitle("equipment.channel"))+" ")]),a("div",[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t._self.$refs["popover-"+t.$index].doClose()}}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(a){return e.deleteChannel(t)}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1),a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[e._v(" "+e._s(e.$translateTitle("developer.delete"))+" ")])],1),a("el-tooltip",{staticClass:"item",attrs:{disabled:"OFFLINE"!=t.row.status,effect:"dark",content:"请先启用通道",placement:"top"}},[a("el-button",{staticStyle:{position:"absolute",width:"100px",height:"10px",opacity:"0"},attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.subProTopic(t.row)}}})],1),a("el-button",{attrs:{disabled:"OFFLINE"==t.row.status,type:"info",size:"mini"},on:{click:function(a){return e.subProTopic(t.row)}}},[e._v(" "+e._s(e.$translateTitle("product.log"))+" ")])]}}])})],1),a("div",{staticClass:"elpagination",staticStyle:{"margin-top":"20px"}},[a("el-pagination",{attrs:{"page-sizes":[10,20,30,50],"page-size":e.length,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.channelSizeChange,"current-change":e.channelCurrentChange}})],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:e.channelupdated+"通道",visible:e.channelForm,"close-on-click-modal":!1,"before-close":e.handleClose,width:"50%",top:"10vh"},on:{"update:visible":function(t){e.channelForm=t}}},[a("el-form",{ref:"addchannel",attrs:{model:e.addchannel,rules:e.addrules,"label-width":"auto"}},[a("el-form-item",{attrs:{label:e.$translateTitle("developer.channeltype"),prop:"region"}},[a("el-select",{attrs:{disabled:"",placeholder:e.$translateTitle("developer.channeltype")},on:{change:e.removeauto},model:{value:e.addchannel.region,callback:function(t){e.$set(e.addchannel,"region",t)},expression:"addchannel.region"}},e._l(e.channelregion,(function(e,t){return a("el-option",{key:t,attrs:{label:e.title.zh,value:e.cType}})})),1),a("el-row",{staticStyle:{width:"100%","min-height":"0","max-height":"100px","margin-top":"20px","text-align":"center"},attrs:{gutter:24}},e._l(e.channelregion,(function(t,n){return a("el-col",{key:n,staticStyle:{cursor:"pointer"},attrs:{span:24}},[t.params.ico&&t.params.ico.default?a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.addchannel.region==t.cType,expression:"addchannel.region == item.cType"}],staticClass:"box-card",style:{display:e.addchannel.region==t.cType?"block":"none",color:e.addchannel.region==t.cType?"#00bad0":"#c0c4cc"},attrs:{shadow:e.addchannel.region==t.cType?"always":"hover",size:"mini"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v(e._s(t.title.zh))]),a("el-button",{staticStyle:{float:"right"},attrs:{disabled:""!=e.resourceid,type:"success",size:"mini"},on:{click:function(a){return e.setCard(t.cType)}}},[e._v(" "+e._s(e.$translateTitle("product.selected"))+" ")])],1),a("div",{staticClass:"text item"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:12}},[a("img",{staticClass:"image",staticStyle:{width:"50px",height:"50px"},attrs:{src:t.params.ico.default?t.params.ico.default:""}})]),a("el-col",{attrs:{span:12}},[a("el-tag",[e._v(e._s(t.cType))])],1)],1)],1)]):e._e()],1)})),1)],1),a("el-form-item",{attrs:{label:e.$translateTitle("developer.channelname"),prop:"name"}},[a("el-input",{attrs:{placeholder:e.$translateTitle("developer.channelname"),autocomplete:"off"},model:{value:e.addchannel.name,callback:function(t){e.$set(e.addchannel,"name",t)},expression:"addchannel.name"}})],1),a("el-form-item",{attrs:{prop:"applicationtText",label:e.$translateTitle("application.applicationtype")}},[a("el-input",{attrs:{placeholder:e.$translateTitle("product.pleaseselectyourapp"),readonly:""},on:{focus:function(t){e.showTree=!e.showTree}},model:{value:e.addchannel.applicationtText,callback:function(t){e.$set(e.addchannel,"applicationtText",t)},expression:"addchannel.applicationtText"}}),e.showTree?a("div",[a("el-tree",{attrs:{data:e.allApps,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1):e._e()],1),e._l(e.arrlist,(function(t,n){return a("el-col",{key:n,attrs:{span:12}},[a("el-form-item",{attrs:{label:t.title.zh,required:t.required,prop:t.showname}},[a("el-tooltip",{attrs:{effect:"dark",placement:"right-start"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(t.description.zh)+" ")]),a("i",{staticClass:"el-icon-question",staticStyle:{float:"left"}})]),"string"==t.type?a("el-input",{directives:[{name:"show",rawName:"v-show",value:"通道ICO"!==t.title.zh,expression:"item.title.zh !== '通道ICO'"}],staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}}):e._e(),"通道ICO"==t.title.zh?a("el-input",{directives:[{name:"show",rawName:"v-show",value:"通道ICO"==t.title.zh,expression:"item.title.zh == '通道ICO'"}],staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-upload"},on:{click:function(a){return e.uploadCkick(e.addchannel[t.showname],n,"arrlist")}},slot:"append"})],1):"integer"==t.type?a("el-input",{staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,e._n(a))},expression:"addchannel[item.showname]"}}):"boolean"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},[a("el-option",{attrs:{value:!0,label:e.$translateTitle("product.yes")}}),a("el-option",{attrs:{value:!1,label:e.$translateTitle("product.no")}})],1):"enum"==t.type?a("el-select",{staticClass:"notauto",staticStyle:{width:"96%"},model:{value:e.addchannel[t.showname],callback:function(a){e.$set(e.addchannel,t.showname,a)},expression:"addchannel[item.showname]"}},e._l(t.enum,(function(e,n){return a("el-option",{key:n,attrs:{label:t.enum[n],value:t.enum[n]}})})),1):e._e()],1)],1)})),a("el-form-item",{attrs:{label:e.$translateTitle("developer.describe")}},[a("el-input",{attrs:{rows:3,placeholder:e.$translateTitle("developer.describe"),autocomplete:"off",type:"textarea"},on:{change:e.inputChange},model:{value:e.addchannel.desc,callback:function(t){e.$set(e.addchannel,"desc",t)},expression:"addchannel.desc"}})],1)],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticStyle:{"margin-right":"20px"},on:{click:e.handleClose}},[e._v(" "+e._s(e.$translateTitle("developer.cancel"))+" ")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addchannelForm("addchannel")}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,visible:e.dialogVisible,title:e.$translateTitle("equipment.channeldetails"),width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",[a("el-row",[a("el-col",{attrs:{span:12}},[e._v("ID:")]),a("el-col",{attrs:{span:12}},[e._v(e._s(e.resourceid))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Resource Type:")]),a("el-col",{attrs:{span:12}},[e._v(e._s(e.resoucetype))])],1),a("el-row",[a("el-col",{attrs:{span:12}},[e._v("Description:")]),a("el-col",{attrs:{span:12}},[e._v(e._s(e.description))])],1),e._l(e.detailchannel,(function(t,n){return a("el-row",{key:t},[a("el-col",{attrs:{span:12}},[e._v(e._s(n))]),a("el-col",{attrs:{span:12}},[e._v(e._s(t))])],1)}))],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v(" "+e._s(e.$translateTitle("developer.determine"))+" ")])],1)]),a("el-dialog",{attrs:{"append-to-body":!0,title:e.channelname+"日志",visible:e.subdialog,"before-close":e.handleCloseSubdialog,width:"85%"},on:{"update:visible":function(t){e.subdialog=t}}},[a("div",{staticStyle:{"margin-top":"20px"}},[a("pre",{staticClass:"ace_editor",staticStyle:{width:"100%","min-height":"300px"},attrs:{id:"subdialog"}},[e._v("                    "),a("textarea",{staticClass:"ace_text-input",staticStyle:{overflow:"scroll"}}),e._v("      ")])]),a("span",{staticClass:"dialog-footer",staticStyle:{height:"30px"},attrs:{slot:"footer"},slot:"footer"},[a("el-switch",{staticStyle:{display:"inline-block","margin-right":"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","inactive-text":"自动刷新"},on:{change:e.stopsub},model:{value:e.value4,callback:function(t){e.value4=t},expression:"value4"}})],1)])],1)},l=[],i=a("1da1"),s=a("5530"),o=(a("96cf"),a("b0c0"),a("d3b7"),a("25f0"),a("d81d"),a("159b"),a("a4d3"),a("e01a"),a("4e82"),a("4d63"),a("ac1f"),a("89e8")),c=a("5da9"),d=a("bb22"),u=a("1b07"),p=a("5880"),m=a("c620"),h=a("ca61"),f=Object(s["a"])(Object(s["a"])({components:{VabInput:h["default"]},data:function(){return{channeltopic:"",channeindex:0,channeType:"",listLoading:!1,dialogVisible:!1,isopen:"suo",pwdType:"password",tableData:[],channelForm:!1,channelupdated:"新增",activeName:"first",channelformsearch:{name:""},channelregion:[],addchannel:{region:"",desc:"",applicationtText:""},applicationList:[],addrules:{applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]},length:10,start:0,total:0,selectregion:{},resourceid:"",resoucetype:"",description:"",detailchannel:"",subdialog:!1,value4:"",subdialogid:"",subdialogtimer:null,channelname:"",arrlist:[],channelId:"",channelrow:[],showTree:!1,allApps:[],defaultProps:{children:"children",label:"label"}}}},Object(p["mapGetters"])({roleTree:"user/roleTree"})),{},{mounted:function(){this.Get_Re_Channel(0),this.dialogType(),this.getApplication()},methods:{uploadCkick:function(e,t,a){this.channeindex=t,this.channeType=a,this.$refs["uploadFinish"].$refs.uploader.dispatchEvent(new MouseEvent("click"))},fileInfo:function(e){"arrlist"==this.channeType?this.arrlist[this.channeindex].default=e.url:this.channelregion[this.channeindex].params.ico.default=e.url},addchannelForm:function(e){var t=this;this.resourceid?this.editChannel(this.resourceid,e):this.$refs[e].validate((function(e){if(e&&t.addchannel.applicationtText){var a={};for(var n in t.addchannel)a[n]=t.addchannel[n];delete a.region,delete a.desc,delete a.type,delete a.isEnable,delete a.name;var r="role:"+t.addchannel.applicationtText,l={};l[r]={read:!0,write:!0};var i={ACL:l,config:a,name:t.addchannel.name,cType:t.addchannel.region,desc:t.addchannel.desc,isEnable:!1,status:"OFFLINE",type:t.addchannel.type.toString()};t.addchannelaxios(i)}else t.$message("有必填项未填")}))},addchannelaxios:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["postChannel"])(e).then((function(e){e&&(t.$message({type:"success",message:"编辑"==t.channelupdated?"编辑成功":"创建成功"}),t.$refs["addchannel"].resetFields(),t.addchannel={},t.channelForm=!1,t.resourceid="")}));case 2:case"end":return a.stop()}}),a)})))()},handleNodeClick:function(e){this.showTree=!this.showTree,this.$set(this.addchannel,"applicationtText",e.name)},inputChange:function(e){},validUrl:function(e,t,a){var n=/^[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/;n.test(t)?a():a(new Error("需要输入正确的url"))},validPort:function(e,t,a){var n=/^([0-9]|[1-9]\d|[1-9]\d{2}|[1-9]\d{3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/;n.test(t)?a():a(new Error("需要输入正确的端口号"))},Get_Re_Channel:function(){var e=arguments,t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r,l,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:0,t.listLoading=!0,t.tableData=[],t.total=0,t.start=0==n?0:t.start,r={skip:t.start,limit:t.length,order:"-createdAt",keys:"count(*)"},a.next=8,Object(o["queryChannel"])(r);case 8:l=a.sent,i=l.count,s=l.results,t.total=i,t.tableData=s,t.listLoading=!1;case 14:case"end":return a.stop()}}),a)})))()},getApplication:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={limit:100},t.next=3,Object(c["queryRole"])(a);case 3:n=t.sent,r=n.results,r.map((function(t){var a={};a.id=t.id,a.name=t.desc,e.applicationList.push(a)}));case 6:case"end":return t.stop()}}),t)})))()},dialogType:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.allApps=e.roleTree,t.next=3,Object(u["resourceTypes"])();case 3:a=t.sent,a.forEach((function(e){e.params.ico||(e.params.ico={title:{en:"channel ICO",zh:"通道ICO"},description:{en:"channel ICO",zh:"通道ICO"},default:"http://dgiot-1253666439.cos.ap-shanghai-fsi.myqcloud.com/logo/logo.png"})})),e.channelregion=a;case 6:case"end":return t.stop()}}),t)})))()},switchEnable:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=t?"enable":"disable",n.prev=1,n.next=4,Object(d["subupadte"])(e,t);case 4:r=n.sent,l=r.updatedAt,l&&(a.$message.success(a.$translateTitle("developer.".concat(t))+""+a.$translateTitle("node.success")),a.Get_Re_Channel(0)),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](1),a.$message.error("".concat(n.t0));case 12:case"end":return n.stop()}}),n,null,[[1,9]])})))()},updateChannel:function(e){this.dialogVisible=!0,this.resourceid=e.objectId,this.detailchannel=e.config,this.resoucetype=e.cType,this.description=e.desc},editChannel:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,l,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r in n={},a.addchannel)n[r]=a.addchannel[r];return delete n.region,delete n.desc,delete n.type,delete n.isEnable,delete n.name,l={config:n,name:a.addchannel.name,cType:a.addchannel.region,desc:a.addchannel.desc},t.next=10,Object(o["putChannel"])(e,l);case 10:i=t.sent,i.updatedAt&&(a.$message({type:"success",message:"编辑成功"}),a.$refs["addchannel"].resetFields(),a.addchannel={},a.channelForm=!1,a.resourceid="",a.Get_Re_Channel(0));case 12:case"end":return t.stop()}}),t)})))()},deleteChannel:function(e){this.delchannelaxios(e)},delchannelaxios:function(e){var t=this;Object(o["delChannel"])(e.row.objectId).then((function(a){t.$message({type:"success",message:"删除成功"}),e._self.$refs["popover-".concat(e.$index)].doClose(),t.Get_Re_Channel(0)})).catch((function(e){}))},addchanneltype:function(){this.$router.push({path:"/CreateResourcechannel",query:{type:"create"}})},handleClose:function(){this.addchannel={},this.channelForm=!1,this.$refs["addchannel"].resetFields(),this.resourceid=""},getChannelEnable:function(e,t){return 1==e.row.isEnable?"green_active":"red_active"},channelSizeChange:function(e){this.length=e,this.Get_Re_Channel(1)},channelCurrentChange:function(e){this.start=(e-1)*this.length,this.Get_Re_Channel(1)},arrSort:function(e,t){var a=e.order,n=t.order;return a<n?-1:a>n?1:0},orderObject:function(e){var t=[];for(var a in e)e[a].showname=a,t.push(e[a]);return t.sort(this.arrSort)},setCard:function(e){this.removeauto(e)},removeauto:function(e){var t=this,a={},n={applicationtText:[{required:!0,message:"请选择所属应用",trigger:"change"}],roles:[{required:!0,message:"请选择所属应用",trigger:"blur"}],name:[{required:!0,message:"请输入通道名称",trigger:"blur"}],region:[{required:!0,message:"请选择服务类型",trigger:"change"}]};if(""==this.resourceid?this.channelregion.map((function(r){r.cType==e&&(t.$forceUpdate(),t.selectregion=r,t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(e){e.default?a[e.showname]=e.default:a[e.showname]="",e.required&&("string"==e.type||"integer"==e.type?n[e.showname]=[{required:!0,trigger:"blur"}]:n[e.showname]=[{required:!0,trigger:"change"}])})),a.region=e,a.desc="",a.name="",a.type=t.selectregion.type,a.isEnable=!1)})):this.channelregion.map((function(r){r.cType==e&&(t.selectregion=r,t.$forceUpdate(),t.arrlist=t.orderObject(t.selectregion.params),t.arrlist.map((function(r){for(var l in t.channelrow.config)r.showname==l&&(a[r.showname]=t.channelrow.config[l]),r.required&&("string"==r.type||"integer"==r.type?n[r.showname]=[{required:!0,trigger:"blur"}]:n[r.showname]=[{required:!0,trigger:"change"}]),a.region=e,a.desc=t.channelrow.desc,a.name=t.channelrow.name,a.type=t.selectregion.type,a.isEnable=t.channelrow.isEnable})))})),this.channelrow)for(var r in this.channelrow.ACL)a.applicationtText=r?r.substr(5):"";this.addchannel=a,this.addchannel.region=e,this.addrules=n},editorChannel:function(e){this.channelrow=e,this.resourceid=e.objectId,this.channelForm=!0,this.channelupdated="编辑",this.removeauto(e.cType)},nowtime:function(){var e=Date.parse(new Date),t=new Date(e),a=(t.getFullYear(),t.getMonth()+1<=10?t.getMonth():t.getMonth(),t.getDate()+1<=10?t.getDate():t.getDate(),(t.getHours()+1<=10?"0"+t.getHours():t.getHours())+":"),n=(t.getMinutes()+1<=10?"0"+t.getMinutes():t.getMinutes())+":",r=t.getSeconds()+1<=10?"0"+t.getSeconds():t.getSeconds();return a+n+r+" "},mqttMsg:function(e){},subProTopic:function(e){this.subdialog=!0,this.subdialogid=e.objectId,this.channelname=e.objectId,setTimeout((function(){n=ace.edit("subdialog"),n.session.setMode("ace/mode/text"),n.setTheme("ace/theme/gob"),n.setReadOnly(!0),n.setOptions({enableBasicAutocompletion:!1,enableSnippets:!0,enableLiveAutocompletion:!0})}));var t={topic:"log/channel/"+e.objectId,qos:2},a=new RegExp("log/channel/"+e.objectId),r="",l=this;l.channeltopic=t.topic,l.$refs.mqtt.clientMqtt(),m["Websocket"].add_hook(a,(function(e){n.session.getLength()>=1e3?r="":r+=l.nowtime()+e+"\n",n.setValue(r),n.gotoLine(n.session.getLength())}));var i=JSON.stringify({action:"start_logger"});m["Websocket"].subscribe(t,(function(t){if(t.result){var a={topic:"channel/"+e.objectId,text:i,retained:!0,qos:2};m["Websocket"].sendMessage(a),l.subdialogtimer=window.setInterval((function(){m["Websocket"].sendMessage(a)}),6e5)}}))},stopsub:function(e){var t;t=0==e?JSON.stringify({action:"stop_logger"}):JSON.stringify({action:"start_logger"});var a={topic:"channel/"+this.subdialogid,text:t,retained:!0,qos:2};m["Websocket"].sendMessage(a)},handleCloseSubdialog:function(){this.subdialog=!1;var e=JSON.stringify({action:"stop_logger"}),t={topic:"channel/"+this.subdialogid,text:e,retained:!0,qos:2};m["Websocket"].sendMessage(t),window.clearInterval(this.subdialogtimer),this.subdialogtimer=null}}}),g=f,b=(a("cc85"),a("2877")),v=Object(b["a"])(g,r,l,!1,null,"47afc0f7",null);t["default"]=v.exports}}]);